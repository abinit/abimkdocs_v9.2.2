



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/tddft/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.6.6">
    
    
      
        <title>Tddft - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#tutorial-on-tddft" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Tutorial
                </span>
              
            
            Tddft
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            9.2.2
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/a-TDEP/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-14" type="checkbox" id="nav-1-14">
    
    <label class="md-nav__link" for="nav-1-14">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-14">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_MacOS/" title="MacOS" class="md-nav__link">
      MacOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_Ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_CentOS/" title="CentOS" class="md-nav__link">
      CentOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_EasyBuild/" title="EasyBuild" class="md-nav__link">
      EasyBuild
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BoundingProcess/" title="BoundingProcess" class="md-nav__link">
      BoundingProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedDFT/" title="ConstrainedDFT" class="md-nav__link">
      ConstrainedDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CrossingBarriers/" title="CrossingBarriers" class="md-nav__link">
      CrossingBarriers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DynamicsMultibinit/" title="DynamicsMultibinit" class="md-nav__link">
      DynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffectiveMass/" title="EffectiveMass" class="md-nav__link">
      EffectiveMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FitProcess/" title="FitProcess" class="md-nav__link">
      FitProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LatticeModel/" title="LatticeModel" class="md-nav__link">
      LatticeModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/longwave/" title="Longwave" class="md-nav__link">
      Longwave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Macroave/" title="Macroave" class="md-nav__link">
      Macroave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SpinDynamicsMultibinit/" title="SpinDynamicsMultibinit" class="md-nav__link">
      SpinDynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/a-TDEP/" title="a TDEP" class="md-nav__link">
      a TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/atdep/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compilation/" title="Building Abinit" class="md-nav__link">
      Building Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph_intro/" title="Eph intro" class="md-nav__link">
      Eph intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4mob/" title="Eph4mob" class="md-nav__link">
      Eph4mob
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4zpr/" title="Eph4zpr" class="md-nav__link">
      Eph4zpr
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      EPH-legacy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        EPH-legacy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11">
    
    <label class="md-nav__link" for="nav-4-11">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      Multibinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        Multibinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../lattice_model/" title="Lattice Model" class="md-nav__link">
      Lattice Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin_model/" title="Spin Model" class="md-nav__link">
      Spin Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Tddft
      </label>
    
    <a href="./" title="Tddft" class="md-nav__link md-nav__link--active">
      Tddft
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#time-dependent-density-functional-theory-casidas-approach" title="Time-Dependent Density Functional Theory, Casida's approach." class="md-nav__link">
    Time-Dependent Density Functional Theory, Casida's approach.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brief-theoretical-introduction" title="Brief theoretical introduction" class="md-nav__link">
    Brief theoretical introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-first-computation-of-electronic-excitation-energies-and-oscillator-strengths-for-n_2_2" title="A first computation of electronic excitation energies and oscillator strengths, for N_2_2" class="md-nav__link">
    A first computation of electronic excitation energies and oscillator strengths, for N_2_2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-studies" title="Convergence studies" class="md-nav__link">
    Convergence studies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-choice-of-the-exchange-correlation-potential" title="The choice of the exchange-correlation potential" class="md-nav__link">
    The choice of the exchange-correlation potential
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/git_and_gitlab/" title="Git and Gitlab" class="md-nav__link">
      Git and Gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/developers_howto/" title="HowTo for developers" class="md-nav__link">
      HowTo for developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Test Suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Test Suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test list" class="md-nav__link">
      Test list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite_howto/" title="Test Suite Howto" class="md-nav__link">
      Test Suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/new_testsuite/" title="YAML-based test suite Howto" class="md-nav__link">
      YAML-based test suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/yaml_tools_api/" title="YAML-based test suite Python tools and API" class="md-nav__link">
      YAML-based test suite Python tools and API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/XgType/" title="XgType" class="md-nav__link">
      XgType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testlink/" title="Test Page for linkcheck" class="md-nav__link">
      Test Page for linkcheck
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/history/" title="History" class="md-nav__link">
      History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#time-dependent-density-functional-theory-casidas-approach" title="Time-Dependent Density Functional Theory, Casida's approach." class="md-nav__link">
    Time-Dependent Density Functional Theory, Casida's approach.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brief-theoretical-introduction" title="Brief theoretical introduction" class="md-nav__link">
    Brief theoretical introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-first-computation-of-electronic-excitation-energies-and-oscillator-strengths-for-n_2_2" title="A first computation of electronic excitation energies and oscillator strengths, for N_2_2" class="md-nav__link">
    A first computation of electronic excitation energies and oscillator strengths, for N_2_2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convergence-studies" title="Convergence studies" class="md-nav__link">
    Convergence studies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-choice-of-the-exchange-correlation-potential" title="The choice of the exchange-correlation potential" class="md-nav__link">
    The choice of the exchange-correlation potential
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/tddft.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="tutorial-on-tddft">Tutorial on TDDFT<a class="headerlink" href="#tutorial-on-tddft" title="Permanent link">&para;</a></h1>
<h2 id="time-dependent-density-functional-theory-casidas-approach">Time-Dependent Density Functional Theory, Casida&rsquo;s approach.<a class="headerlink" href="#time-dependent-density-functional-theory-casidas-approach" title="Permanent link">&para;</a></h2>
<p>This tutorial aims at showing how to get the following physical properties, for finite systems:</p>
<ul>
<li>Excitation energies</li>
<li>Associated oscillator strengths</li>
<li>Frequency-dependent polarizability and optical spectra</li>
</ul>
<p>in the Casida approach, within Time-Dependent Density Functional Theory.</p>
<p>This tutorial should take about 30 minutes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own install of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the absolute path of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package, especially the executable and test files.</p>
<p>To execute the tutorials, create a working directory (<code class="codehilite">Work*</code>) and
copy there the input files and the <em>files</em> file of the lesson. This will be explicitly mentioned in the first lessons,
that will tell you more about the <em>files</em> file (see also <a class="wikilink user-guide-wikilink" href="../../guide/abinit#intro">section 1.1</a>).
The <em>files</em> file ending with <em>_x</em> (e.g. <em>tbase1_x.files</em>) <strong>must be edited</strong> every time you start to use a new input file.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="../basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel, see the <a class="wikilink topic-wikilink" data-content="How to set parameters for a parallel calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/parallelism">topic on parallelism</a>.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define some handy environment variables by
executing the following lines in the terminal:</p>
<div class="codehilite"><pre><span></span><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_the_absolute_path_to_the_abinit_top_level_dir
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Pseudopotentials used in examples.</span>
</pre></div>

<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>).
The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
</div>
<h2 id="brief-theoretical-introduction">Brief theoretical introduction<a class="headerlink" href="#brief-theoretical-introduction" title="Permanent link">&para;</a></h2>
<p>In order to perform Time-Dependent Density Functional Theory calculations (TDDFT)
of electronic excitations and oscillator strengths, in the Casida&rsquo;s approach,
you should first have some theoretical background.
TDDFT was first developed in the eighties, but the direct calculation of
electronic excitations was introduced much later, by Casida and co-workers.
A comprehensive description of the underlying formalism is given in</p>
<div class="codehilite"><pre><span></span>&quot;Time-Dependent Density Functional Response Theory of Molecular Systems:
 Theory, Computational Methods, and Functionals&quot;
 M. E. Casida
 in Recent Development and Applications of Modern Density Functional Theory,
 edited by J.M. Seminario (Elsevier, Amsterdam, 1996), p. 391.
 &lt;http://dx.doi.org/10.1016/S1380-7323(96)80093-8&gt;
</pre></div>


<p>However this reference might be hard to get, that is why we have based the
tutorial instead on the following (also early) papers:
<a class="wikilink citation-wikilink" data-content="Molecular excitation energies to high-lying bound states from time-dependent density-functional response theory: Characterization and correction of the time-dependent local density approximation ionization threshold" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#casida1998">[Casida1998]</a>, <a class="wikilink citation-wikilink" data-content="Excited-state potential energy curves from time-dependent density-functional theory: A cross section of formaldehyde&amp;#x27;s 1A1 manifold" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#casida1998a">[Casida1998a]</a>, and <a class="wikilink citation-wikilink" data-content="Ab InitioExcitation Spectra and Collective Electronic Response in Atoms and Clusters" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#vasiliev1998">[Vasiliev1998]</a>.</p>
<p>The first of these papers, <a class="wikilink citation-wikilink" data-content="Molecular excitation energies to high-lying bound states from time-dependent density-functional response theory: Characterization and correction of the time-dependent local density approximation ionization threshold" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#casida1998">[Casida1998]</a>, will be used as main reference for our tutorial.</p>
<p>From these papers, you will learn that a TDDFT calculation of electronic
excitation energies start first from a usual ground-state calculation, with a
chosen XC functional. Such a calculation produces a spectrum of Kohn-Sham
electronic energies. It is widely known that differences between occupied and
unoccupied Kohn-Sham electronic energies resemble excitation energies (the
difference in energy between an excited state and the ground state), although
there is no real theoretical justification for this similarity.</p>
<p>These differences between Kohn-Sham electronic energies are the starting point
of Casida&rsquo;s approach: in the framework of TDDFT, their square give the main
contribution to the diagonal part of a matrix, whose eigenvalues will be the
square of the excitation energies. One has to add to the diagonal matrix made
from the squares of Kohn-Sham energy differences, a coupling matrix, whose
elements are four-wavefunction integrals of the Coulomb and exchange-correlation kernel.
The exchange-correlation kernel contribution will differ
in the spin-singlet and in the spin-triplet states, this being the only
difference between spin-singlet and spin-triplet states. See Eqs.(1.3) and
(1.4) of <a class="wikilink citation-wikilink" data-content="Excited-state potential energy curves from time-dependent density-functional theory: A cross section of formaldehyde&amp;#x27;s 1A1 manifold" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#casida1998a">[Casida1998a]</a>, and Eqs.(1-2) of <a class="wikilink citation-wikilink" data-content="Ab InitioExcitation Spectra and Collective Electronic Response in Atoms and Clusters" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#vasiliev1998">[Vasiliev1998]</a>.</p>
<p>The construction of the coupling matrix can be done on the basis of an
exchange-correlation kernel that is derived from the exchange-correlation
functional used for the ground-state, but this is not a requirement of the
theory, since such a correspondence only holds for the exact functional. In
practice, the approximation to the XC potential and the one to the XC kernel
are often different. See section III of <a class="wikilink citation-wikilink" data-content="Molecular excitation energies to high-lying bound states from time-dependent density-functional response theory: Characterization and correction of the time-dependent local density approximation ionization threshold" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#casida1998">[Casida1998]</a>.</p>
<p>A big drawback of the currently known XC potentials and XC kernels is observed
when the system is infinite in at least one direction (e.g. polymers, slabs,
or solids). In this case, the addition of the coupling matrix is unable to
shift the edges of the Kohn-Sham band structure (each four-wavefunction
integral becomes too small). There is only a redistribution of the oscillator
strengths. In particular, the DFT band gap problem is NOT solved by TDDFT.
Also, the Casida&rsquo;s approach relies on the discreteness of the Kohn-Sham spectrum.</p>
<p>Thus, the TDDFT approach to electronic excitation energies in ABINIT is ONLY
valid for finite systems (atoms, molecules, clusters). Actually, only one
k-point can be used, and a &ldquo;box center&rdquo; must be defined, close to the center
of gravity of the system.</p>
<p>The Casida formalism also gives access to the oscillator strengths, needed to
obtain the frequency-dependent polarizability, and corresponding optical
spectrum. In the ABINIT implementation, the oscillators strengths are given as
a second-rank tensor, in cartesian coordinates, as well as the average over
all directions usually used for molecules and clusters. It is left to the user
to generate the polarisability spectrum, according to e.g. Eq.(1.2) of <a class="wikilink citation-wikilink" data-content="Excited-state potential energy curves from time-dependent density-functional theory: A cross section of formaldehyde&amp;#x27;s 1A1 manifold" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#casida1998a">[Casida1998a]</a>.</p>
<p>One can also combine the ground state total energy with the electronic
excitation energies to obtain Born-Oppenheimer potential energy curves for
excited states. This is illustrated for formaldehyde in <a class="wikilink citation-wikilink" data-content="Excited-state potential energy curves from time-dependent density-functional theory: A cross section of formaldehyde&amp;#x27;s 1A1 manifold" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#casida1998a">[Casida1998a]</a>.</p>
<p>Given its simplicity, and the relatively modest CPU cost of this type of
calculation, Casida&rsquo;s approach enjoys a wide popularity. There has been
hundreds of papers published on the basis of methodology. Still, its accuracy
might be below the expectations, as you will see. As often, test this method
to see if it suits your needs, and read the recent literature &hellip;</p>
<h2 id="a-first-computation-of-electronic-excitation-energies-and-oscillator-strengths-for-n_2_2">A first computation of electronic excitation energies and oscillator strengths, for N<span><span class="MathJax_Preview">_2</span><script type="math/tex">_2</script></span><a class="headerlink" href="#a-first-computation-of-electronic-excitation-energies-and-oscillator-strengths-for-n_2_2" title="Permanent link">&para;</a></h2>
<p>We will now compute and analyse the excitation energies of the diatomic molecule N<span><span class="MathJax_Preview">_2</span><script type="math/tex">_2</script></span>.
This is a rather simple s.ystem, with cylindrical symmetry,
allowing interesting understanding. Although we will suppose that you are
familiarized with quantum numbers for diatomic molecules, this should not play
an important role in the understanding of the way to use Abinit
implementation of Casida&rsquo;s formalism.</p>
<p><em>Before beginning, you might consider to work in a different subdirectory as
for the other tutorials. Why not Work_tddft?</em>
Copy the files <em>ttddft_x.files</em> and <em>ttddft_1.in</em> in <em>Work_tddft</em>:</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> <span class="nv">$ABI_TESTS</span>/tutorial/Input
mkdir Work_tddft
<span class="nb">cd</span> Work_tddft
cp ../ttddft_x.files .
cp ../ttddft_1.in .
</pre></div>

<p>So, issue now:</p>
<div class="codehilite"><pre><span></span>abinit &lt; ttddft_x.files &gt; log 2&gt; err &amp;
</pre></div>


<p>The computation is quite fast: about 15 secs on a 2.8 GHz PC.
Let&rsquo;s examine the input file <em>ttddft_1.in</em>.</p>
<div class="text-center"><button type="button" id="uuid-54c11fdc-45e7-4d0e-9507-0d87b4010ff7" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Input/ttddft_1.in
</button></div>

<div id="uuid-4d5d8598-1f6f-49f6-aa6f-bf82f3b80b71" class="my_dialog" title="tests/tutorial/Input/ttddft_1.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># N2 system. </span>
<span class="c1"># Excited state computation, using LDA/TDLDA</span>

 ndtset    <span class="m">2</span>

<span class="c1">#DATASET 1  SCF</span>
 tolwfr1   <span class="m">1</span>.0d-15
  nband1   <span class="m">5</span>
 prtden1   <span class="m">1</span>
 getwfk1   <span class="m">0</span>

<span class="c1">#DATASET 2 TDDFT</span>
   iscf2  -1
 tolwfr2   <span class="m">1</span>.0d-9
  nband2   <span class="m">12</span>
 getden2   <span class="m">1</span>
 getwfk2   <span class="m">1</span>

<span class="c1">#Common</span>
 acell <span class="m">6</span>  <span class="m">2</span>*5 Angstrom
 boxcenter <span class="m">3</span>*0.0d0
 diemac <span class="m">1</span>.0d0   diemix <span class="m">0</span>.5d0
 ecut <span class="m">25</span>
 ixc  <span class="m">7</span>

kptopt <span class="m">0</span>          <span class="c1"># Enter the k points manually </span>

 natom  <span class="m">2</span> 
 nbdbuf <span class="m">0</span>

 nstep <span class="m">25</span>
 ntypat  <span class="m">1</span>
 typat  <span class="m">1</span> <span class="m">1</span>
 xcart -0.54885  <span class="m">0</span> <span class="m">0</span>  <span class="m">0</span>.54885 <span class="m">0</span> <span class="m">0</span> Angstrom   ! Distance <span class="m">1</span>.0977 Angstrom
 znucl  <span class="m">7</span>


 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;PseudosHGH_pwteter/7n.5.hgh&quot;</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   ttddft_1.out, tolnlines=  6, tolabs=  1.010e-02, tolrel=  4.000e-01</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = Unknown</span>
<span class="c1">#%% keywords = TDDFT</span>
<span class="c1">#%% description = </span>
<span class="c1">#%%  N2 system. </span>
<span class="c1">#%%  Excited state computation, using LDA/TDLDA</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-4d5d8598-1f6f-49f6-aa6f-bf82f3b80b71", "#uuid-54c11fdc-45e7-4d0e-9507-0d87b4010ff7") }); </script>

<p>There are two datasets: the first one corresponds to a typical ground-state
calculation, with only occupied bands. The density and wavefunctions are
written, for use in the second data set. The second dataset is the one where
the TDDFT calculation is done. Moreover, the non-self-consistent calculation
of the occupied eigenfunctions and corresponding eigenenergies is also
accomplished. This is obtained by setting <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a> to -1.</p>
<p>Please, take now some time to read the information about this value of <a class="wikilink codevar-wikilink" href="../../variables/basic#iscf">iscf</a>, and the few
input variables that acquire some meaning in this context (namely,
<a class="wikilink codevar-wikilink" href="../../variables/gstate#boxcenter">boxcenter</a>, <a class="wikilink codevar-wikilink" href="../../variables/dfpt#td_mexcit">td_mexcit</a>, and <a class="wikilink codevar-wikilink" href="../../variables/dfpt#td_maxene">td_maxene</a>). Actually, this is most of
the information that should be known to use the TDDFT in ABINIT!</p>
<p>You will note that we have 5 occupied bands (defined for dataset 1), and that
we add 7 unoccupied bands in the dataset 2, to obtain a total of 12 bands. The
box is not very large (6x5x5 Angstrom), the cutoff is quite reasonable, 25
Hartree), and as requested for the Casida&rsquo;s formalism, only one k point is
used. We have chosen the Perdew-Wang 92 LDA functional for both the self-
consistent and non-self-consistent calculations (<a class="wikilink codevar-wikilink" href="../../variables/basic#ixc">ixc</a> = 7).</p>
<p>We can now examine the output file <em>ttddft_1.out.</em></p>
<div class="text-center"><button type="button" id="uuid-a4353d8b-a937-486d-a7d1-be4b7deddce9" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutorial/Refs/ttddft_1.out
</button></div>

<div id="uuid-5f1f3dcb-d93d-492d-a24b-041fe2b42964" class="my_dialog" title="tests/tutorial/Refs/ttddft_1.out" hidden><div><pre class="small-text">

.Version 9.0.0 of ABINIT 
.(MPI version, prepared for a x86_64_linux_gnu9.2 computer) 

.Copyright (C) 1998-2020 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Mon 24 Feb 2020.
- ( at 16h47 )

- input  file    -&gt; /home/gmatteo/git_repos/abinit/_abiref_gnu9.2_openmpi/tests/Test_suite/tutorial_ttddft_1/ttddft_1.in
- output file    -&gt; ttddft_1.out
- root for input  files -&gt; ttddft_1i
- root for output files -&gt; ttddft_1o


 DATASET    1 : space group P4/m m m (#123); Bravais tP (primitive tetrag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       1
     lnmax =       1     mgfft =      54  mpssoang =       2    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      16    n1xccc =       0    ntypat =       1
    occopt =       1   xclevel =       1
-    mband =           5        mffmem =           1         mkmem =           1
       mpw =        3031          nfft =      109350          nkpt =           1
================================================================================
P This job should need less than                      30.435 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.233 Mbytes ; DEN or POT disk file :      0.836 Mbytes.
================================================================================


 DATASET    2 : space group P4/m m m (#123); Bravais tP (primitive tetrag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       0      iscf =      -1    lmnmax =       1
     lnmax =       1     mgfft =      54  mpssoang =       2    mqgrid =    5105
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      16    n1xccc =       0    ntypat =       1
    occopt =       1   xclevel =       1
-    mband =          12        mffmem =           1         mkmem =           1
       mpw =        3031          nfft =      109350          nkpt =           1
 For the susceptibility and dielectric matrices, or tddft :
   mgfft =        54  nbnd_in_blk=     6    nfft =    109350     npw =     48395
================================================================================
P This job should need less than                      25.477 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.557 Mbytes ; DEN or POT disk file :      0.836 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values                                      
-   iomode0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file              
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      1.1338356797E+01  9.4486306644E+00  9.4486306644E+00 Bohr
              amu      1.40067400E+01
        boxcenter      0.00000000E+00  0.00000000E+00  0.00000000E+00
           diecut1     2.20000000E+00 Hartree
           diecut2     1.00000000E+02 Hartree
           diemac      1.00000000E+00
           diemix      5.00000000E-01
             ecut      2.50000000E+01 Hartree
-          fftalg         312
           getden1          0
           getden2          1
           getwfk1          0
           getwfk2          1
             iscf1          7
             iscf2         -1
           istwfk        2
              ixc           7
           jdtset        1    2
           kptopt           0
P           mkmem           1
            natom           2
            nband1          5
            nband2         12
           ndtset           2
            ngfft          54      45      45
             nkpt           1
            nstep          25
             nsym          16
           ntypat           1
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
          spgroup         123
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                      -1  0  0   0 -1  0   0  0  1       1  0  0   0  1  0   0  0 -1
                       1  0  0   0 -1  0   0  0 -1      -1  0  0   0  1  0   0  0  1
                      -1  0  0   0  1  0   0  0 -1       1  0  0   0 -1  0   0  0  1
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                      -1  0  0   0  0 -1   0  1  0       1  0  0   0  0  1   0 -1  0
                       1  0  0   0  0 -1   0 -1  0      -1  0  0   0  0  1   0  1  0
                      -1  0  0   0  0  1   0 -1  0       1  0  0   0  0 -1   0  1  0
           tolwfr1     1.00000000E-15
           tolwfr2     1.00000000E-09
            typat      1  1
           xangst     -5.4885000000E-01  0.0000000000E+00  0.0000000000E+00
                       5.4885000000E-01  0.0000000000E+00  0.0000000000E+00
            xcart     -1.0371761880E+00  0.0000000000E+00  0.0000000000E+00
                       1.0371761880E+00  0.0000000000E+00  0.0000000000E+00
             xred     -9.1475000000E-02  0.0000000000E+00  0.0000000000E+00
                       9.1475000000E-02  0.0000000000E+00  0.0000000000E+00
            znucl        7.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 1, mband: 5, nsppol: 1, nspinor: 1, nspden: 1, mpw: 3031, }
cutoff_energies: {ecut:  25.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.00000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 0, ionmov: 0, optcell: 0, iscf: 7, paral_kgb: 0, }
...

 Exchange-correlation functional for the present dataset will be:
  LDA: Perdew-Wang 92 LSD fit to Ceperley-Alder data - ixc=7
 Citation for XC functional:
  J.P.Perdew and Y.Wang, PRB 45, 13244 (1992)

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)= 11.3383568  0.0000000  0.0000000  G(1)=  0.0881962  0.0000000  0.0000000
 R(2)=  0.0000000  9.4486307  0.0000000  G(2)=  0.0000000  0.1058354  0.0000000
 R(3)=  0.0000000  0.0000000  9.4486307  G(3)=  0.0000000  0.0000000  0.1058354
 Unit cell volume ucvol=  1.0122502E+03 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  9.00000000E+01 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  54  45  45
         ecut(hartree)=     25.000   =&gt; boxcut(ratio)=   2.06894

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/gmatteo/git_repos/abinit/tests/Psps_for_tests/PseudosHGH_pwteter/7n.5.hgh
- pspatm: opening atomic psp file    /home/gmatteo/git_repos/abinit/tests/Psps_for_tests/PseudosHGH_pwteter/7n.5.hgh
- Hartwigsen-Goedecker-Hutter psp for Nitrogen,  from PRB58, 3641 (1998) paper
-  7.00000   5.00000    980509                znucl, zion, pspdat
    3    1    1    0      2001   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
 rloc=   0.2891790
 cc1 = -12.2348200; cc2 =   1.7664070; cc3 =   0.0000000; cc4 =   0.0000000
 rrs =   0.2566050; h11s=  13.5522430; h22s=   0.0000000; h33s=   0.0000000
 rrp =   0.2701340; h11p=   0.0000000; h22p=   0.0000000; h33p=   0.0000000
                    k11p=   0.0031310; k22p=   0.0000000; k33p=   0.0000000
-  Local part computed in reciprocal space.

 pspatm : COMMENT -
  the projectors are not normalized,
  so that the KB energies are not consistent with 
  definition in PRB44, 8503 (1991). 
  However, this does not influence the results obtained hereafter.
  pspatm : epsatm=   -0.01437983
         --- l  ekb(1:nproj) --&gt;
             0    0.811730
 pspatm: atomic psp has been read  and splines computed

  -2.87596502E-01                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

_setup2: Arith. and geom. avg. npw (full set) are    6061.000    6061.000

================================================================================

--- !BeginCycle
iteration_state: {dtset: 1, }
solver: {iscf: 7, nstep: 25, nline: 4, wfoptalg: 0, }
tolerances: {tolwfr: 1.00E-15, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2
 ETOT  1  -19.237726814420    -1.924E+01 1.580E-01 7.124E+01
 ETOT  2  -19.564986856138    -3.273E-01 8.096E-05 9.338E+01
 ETOT  3  -19.577642309340    -1.266E-02 9.578E-05 3.689E+01
 ETOT  4  -19.584920541023    -7.278E-03 1.932E-04 1.156E+00
 ETOT  5  -19.584912911868     7.629E-06 6.431E-08 1.149E-01
 ETOT  6  -19.584939298162    -2.639E-05 5.696E-07 8.626E-04
 ETOT  7  -19.584939405827    -1.077E-07 1.662E-09 2.404E-05
 ETOT  8  -19.584939403191     2.637E-09 4.383E-11 1.858E-05
 ETOT  9  -19.584939407039    -3.848E-09 8.595E-11 3.720E-08
 ETOT 10  -19.584939407047    -7.557E-12 3.303E-13 1.142E-08
 ETOT 11  -19.584939407049    -1.737E-12 4.112E-14 6.563E-10
 ETOT 12  -19.584939407050    -8.953E-13 6.828E-16 1.385E-11

 At SCF step   12   max residual=  6.83E-16 &lt; tolwfr=  1.00E-15 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  4.01329492E-04  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  4.54084862E-04  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  4.54084862E-04  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [ 11.3383568,   0.0000000,   0.0000000, ]
- [  0.0000000,   9.4486307,   0.0000000, ]
- [  0.0000000,   0.0000000,   9.4486307, ]
lattice_lengths: [  11.33836,    9.44863,    9.44863, ]
lattice_angles: [ 90.000,  90.000,  90.000, ] # degrees, (23, 13, 12)
lattice_volume:   1.0122502E+03
convergence: {deltae: -8.953E-13, res2:  1.385E-11, residm:  6.828E-16, diffor: null, }
etotal    :  -1.95849394E+01
entropy   :   0.00000000E+00
fermie    :  -3.29296197E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  4.01329492E-04,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   4.54084862E-04,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   4.54084862E-04, ]
pressure_GPa:  -1.2842E+01
xred      :
- [ -9.1475E-02,   0.0000E+00,   0.0000E+00,  N]
- [  9.1475E-02,   0.0000E+00,   0.0000E+00,  N]
cartesian_forces: # hartree/bohr
- [ -2.82844045E-02,  -0.00000000E+00,  -0.00000000E+00, ]
- [  2.82844045E-02,  -0.00000000E+00,  -0.00000000E+00, ]
force_length_stats: {min:   2.82844045E-02, max:   2.82844045E-02, mean:   2.82844045E-02, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          5.78852189
    2        2.00000          5.78852189
================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   47.207E-17; max=  68.284E-17
 reduced coordinates (array xred) for    2 atoms
      -0.091475000000      0.000000000000      0.000000000000
       0.091475000000      0.000000000000      0.000000000000
 rms dE/dt=  1.8516E-01; max dE/dt=  3.2070E-01; dE/dt below (all hartree)
    1       0.320698670125      0.000000000000      0.000000000000
    2      -0.320698670125      0.000000000000      0.000000000000

 cartesian coordinates (angstrom) at end:
    1     -0.54885000000000     0.00000000000000     0.00000000000000
    2      0.54885000000000     0.00000000000000     0.00000000000000

 cartesian forces (hartree/bohr) at end:
    1     -0.02828440450925    -0.00000000000000    -0.00000000000000
    2      0.02828440450925    -0.00000000000000    -0.00000000000000
 frms,max,avg= 1.6330009E-02 2.8284405E-02   0.000E+00  0.000E+00  0.000E+00 h/b

 cartesian forces (eV/Angstrom) at end:
    1     -1.45444243602894    -0.00000000000000    -0.00000000000000
    2      1.45444243602894    -0.00000000000000    -0.00000000000000
 frms,max,avg= 8.3972273E-01 1.4544424E+00   0.000E+00  0.000E+00  0.000E+00 e/A
 length scales= 11.338356797314  9.448630664428  9.448630664428 bohr
              =  6.000000000000  5.000000000000  5.000000000000 angstroms
 prteigrs : about to open file ttddft_1o_DS1_EIG
 Fermi (or HOMO) energy (hartree) =  -0.32930   Average Vxc (hartree)=  -0.11513
 Eigenvalues (hartree) for nkpt=   1  k points:
 kpt#   1, nband=  5, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced coord)
  -0.99636   -0.44764   -0.38261   -0.38261   -0.32930

--- !EnergyTerms
iteration_state     : {dtset: 1, }
comment             : Components of total free energy in Hartree
kinetic             :  1.35821842352283E+01
hartree             :  1.41788575939720E+01
xc                  : -4.74575389762336E+00
Ewald energy        : -1.79779420930316E+00
psp_core            : -2.84116027451963E-04
local_psp           : -4.27278830690270E+01
non_local_psp       :  1.92573405573098E+00
total_energy        : -1.95849394070496E+01
total_energy_eV     : -5.32933304080068E+02
band_energy         : -5.07704165999964E+00
...


 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  4.01329492E-04  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  4.54084862E-04  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  4.54084862E-04  sigma(2 1)=  0.00000000E+00

-Cartesian components of stress tensor (GPa)         [Pressure= -1.2842E+01 GPa]
- sigma(1 1)=  1.18075193E+01  sigma(3 2)=  0.00000000E+00
- sigma(2 2)=  1.33596356E+01  sigma(3 1)=  0.00000000E+00
- sigma(3 3)=  1.33596356E+01  sigma(2 1)=  0.00000000E+00

================================================================================
== DATASET  2 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 2, }
dimensions: {natom: 2, nkpt: 1, mband: 12, nsppol: 1, nspinor: 1, nspden: 1, mpw: 3031, }
cutoff_energies: {ecut:  25.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.00000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 0, ionmov: 0, optcell: 0, iscf: -1, paral_kgb: 0, }
...

 mkfilename : getwfk/=0, take file _WFK from output of DATASET   1.

 mkfilename : getden/=0, take file _DEN from output of DATASET   1.

 Exchange-correlation functional for the present dataset will be:
  LDA: Perdew-Wang 92 LSD fit to Ceperley-Alder data - ixc=7
 Citation for XC functional:
  J.P.Perdew and Y.Wang, PRB 45, 13244 (1992)

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)= 11.3383568  0.0000000  0.0000000  G(1)=  0.0881962  0.0000000  0.0000000
 R(2)=  0.0000000  9.4486307  0.0000000  G(2)=  0.0000000  0.1058354  0.0000000
 R(3)=  0.0000000  0.0000000  9.4486307  G(3)=  0.0000000  0.0000000  0.1058354
 Unit cell volume ucvol=  1.0122502E+03 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  9.00000000E+01 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  54  45  45
         ecut(hartree)=     25.000   =&gt; boxcut(ratio)=   2.06894
--------------------------------------------------------------------------------

-inwffil : will read wavefunctions from disk file ttddft_1o_DS1_WFK

================================================================================
 prteigrs : about to open file ttddft_1o_DS2_EIG
 Non-SCF case, kpt    1 (  0.00000  0.00000  0.00000), residuals and eigenvalues=
  3.62E-16  4.35E-16  5.59E-16  5.41E-16  6.60E-16  2.83E-10  6.10E-10  3.38E-10
  2.00E-10  6.99E-10  7.00E-10  5.20E-10
 -9.9636E-01 -4.4764E-01 -3.8261E-01 -3.8261E-01 -3.2930E-01 -1.8408E-02
 -1.8408E-02  1.4740E-02  1.2529E-01  1.5992E-01  1.6973E-01  2.1155E-01


 *** TDDFT : computation of excited states *** 
 Splitting of  12 states in   5 occupied states, and   7 unoccupied states,
 giving    35 excitations.

  Ground state total energy (Ha) :   -1.95849394E+01

  Kohn-Sham energy differences,
  corresponding total energies and oscillator strengths (X,Y,Z and average)-
  (oscillator strengths smaller than 1.e-6 are set to zero)
  Transition  (Ha)  and   (eV)   Tot. Ene. (Ha)  Aver     XX       YY       ZZ
   5-&gt;  6 3.10888E-01 8.45969E+00 -1.92741E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   5-&gt;  7 3.10888E-01 8.45969E+00 -1.92741E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   5-&gt;  8 3.44036E-01 9.36171E+00 -1.92409E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   4-&gt;  6 3.64203E-01 9.91046E+00 -1.92207E+01 1.4462E-01 4.34E-01 0.00E+00 0.00E+00
   3-&gt;  6 3.64203E-01 9.91046E+00 -1.92207E+01 4.2300E-01 1.27E+00 0.00E+00 0.00E+00
   4-&gt;  7 3.64203E-01 9.91046E+00 -1.92207E+01 4.2300E-01 1.27E+00 0.00E+00 0.00E+00
   3-&gt;  7 3.64203E-01 9.91046E+00 -1.92207E+01 1.4462E-01 4.34E-01 0.00E+00 0.00E+00
   4-&gt;  8 3.97351E-01 1.08125E+01 -1.91876E+01 4.0028E-02 0.00E+00 1.20E-01 0.00E+00
   3-&gt;  8 3.97351E-01 1.08125E+01 -1.91876E+01 4.0028E-02 0.00E+00 0.00E+00 1.20E-01
   2-&gt;  6 4.29232E-01 1.16800E+01 -1.91557E+01 3.3964E-01 0.00E+00 2.60E-01 7.59E-01
   2-&gt;  7 4.29232E-01 1.16800E+01 -1.91557E+01 3.3964E-01 0.00E+00 7.59E-01 2.60E-01
   5-&gt;  9 4.54589E-01 1.23700E+01 -1.91304E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   2-&gt;  8 4.62381E-01 1.25820E+01 -1.91226E+01 1.7427E-03 5.23E-03 0.00E+00 0.00E+00
   5-&gt; 10 4.89218E-01 1.33123E+01 -1.90957E+01 1.3424E-01 4.03E-01 0.00E+00 0.00E+00
   5-&gt; 11 4.99024E-01 1.35791E+01 -1.90859E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   4-&gt;  9 5.07904E-01 1.38208E+01 -1.90770E+01 5.4786E-02 0.00E+00 1.64E-01 0.00E+00
   3-&gt;  9 5.07904E-01 1.38208E+01 -1.90770E+01 5.4786E-02 0.00E+00 0.00E+00 1.64E-01
   5-&gt; 12 5.40847E-01 1.47172E+01 -1.90441E+01 1.7144E-01 0.00E+00 5.79E-03 5.09E-01
   4-&gt; 10 5.42533E-01 1.47631E+01 -1.90424E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   3-&gt; 10 5.42533E-01 1.47631E+01 -1.90424E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   4-&gt; 11 5.52339E-01 1.50299E+01 -1.90326E+01 1.0576E-01 0.00E+00 3.17E-01 0.00E+00
   3-&gt; 11 5.52339E-01 1.50299E+01 -1.90326E+01 1.0576E-01 0.00E+00 0.00E+00 3.17E-01
   2-&gt;  9 5.72934E-01 1.55903E+01 -1.90120E+01 5.1067E-02 1.53E-01 0.00E+00 0.00E+00
   4-&gt; 12 5.94161E-01 1.61680E+01 -1.89908E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   3-&gt; 12 5.94161E-01 1.61680E+01 -1.89908E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   2-&gt; 10 6.07563E-01 1.65326E+01 -1.89774E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   2-&gt; 11 6.17368E-01 1.67994E+01 -1.89676E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   2-&gt; 12 6.59191E-01 1.79375E+01 -1.89257E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   1-&gt;  6 9.77954E-01 2.66115E+01 -1.86070E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   1-&gt;  7 9.77954E-01 2.66115E+01 -1.86070E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   1-&gt;  8 1.01110E+00 2.75135E+01 -1.85738E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   1-&gt;  9 1.12166E+00 3.05218E+01 -1.84633E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   1-&gt; 10 1.15628E+00 3.14641E+01 -1.84287E+01 6.5997E-04 1.98E-03 0.00E+00 0.00E+00
   1-&gt; 11 1.16609E+00 3.17309E+01 -1.84188E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   1-&gt; 12 1.20791E+00 3.28690E+01 -1.83770E+01 1.9956E-04 0.00E+00 6.74E-06 5.92E-04
  Sum of osc. strength :     2.575013E+00

  TDDFT singlet excitation energies (at most 20 of them are printed),
  and corresponding total energies.                
  Excit#   (Ha)    and    (eV)    total energy (Ha)    major contributions
   1    3.47952E-01   9.46826E+00   -1.923699E+01    0.83(  5-&gt;  6)  0.17(  5-&gt;  7)
   2    3.48006E-01   9.46971E+00   -1.923693E+01    0.83(  5-&gt;  7)  0.17(  5-&gt;  6)
   3    3.62425E-01   9.86208E+00   -1.922251E+01    0.99(  5-&gt;  8)  0.00(  2-&gt; 10)
   4    3.64202E-01   9.91043E+00   -1.922074E+01    0.37(  3-&gt;  7)  0.37(  4-&gt;  6)
   5    3.84223E-01   1.04553E+01   -1.920072E+01    0.37(  4-&gt;  6)  0.37(  3-&gt;  7)
   6    3.84236E-01   1.04556E+01   -1.920070E+01    0.37(  4-&gt;  7)  0.37(  3-&gt;  6)
   7    3.96699E-01   1.07947E+01   -1.918824E+01    0.99(  3-&gt;  8)  0.01(  4-&gt;  8)
   8    3.96723E-01   1.07954E+01   -1.918822E+01    0.99(  4-&gt;  8)  0.01(  3-&gt;  8)
   9    4.54145E-01   1.23579E+01   -1.913079E+01    1.00(  5-&gt;  9)  0.00(  3-&gt; 12)
  10    4.60223E-01   1.25233E+01   -1.912472E+01    0.90(  2-&gt;  8)  0.03(  3-&gt;  6)
  11    4.85218E-01   1.32034E+01   -1.909972E+01    0.98(  5-&gt; 10)  0.01(  2-&gt;  8)
  12    4.93405E-01   1.34262E+01   -1.909153E+01    1.00(  5-&gt; 11)  0.00(  3-&gt; 12)
  13    5.04250E-01   1.37213E+01   -1.908069E+01    0.80(  3-&gt;  9)  0.15(  2-&gt;  6)
  14    5.04368E-01   1.37246E+01   -1.908057E+01    0.81(  4-&gt;  9)  0.14(  2-&gt;  7)
  15    5.20481E-01   1.41630E+01   -1.906446E+01    0.46(  2-&gt;  6)  0.17(  3-&gt;  9)
  16    5.22450E-01   1.42166E+01   -1.906249E+01    0.50(  2-&gt;  7)  0.22(  4-&gt; 11)
  17    5.36114E-01   1.45884E+01   -1.904883E+01    0.87(  5-&gt; 12)  0.09(  3-&gt; 11)
  18    5.42854E-01   1.47718E+01   -1.904209E+01    0.99(  3-&gt; 10)  0.01(  4-&gt; 10)
  19    5.42854E-01   1.47718E+01   -1.904208E+01    0.99(  4-&gt; 10)  0.01(  3-&gt; 10)
  20    5.63730E-01   1.53399E+01   -1.902121E+01    0.75(  4-&gt; 11)  0.19(  2-&gt;  7)

  Oscillator strengths :  (elements smaller than 1.e-6 are set to zero)
  Excit#   (Ha)   Average    XX        YY        ZZ         XY        XZ        YZ
   1 3.47952E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   2 3.48006E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   3 3.62425E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   4 3.64202E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   5 3.84223E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   6 3.84236E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   7 3.96699E-01 5.759E-02 0.000E+00 1.928E-03 1.709E-01  0.00E+00  0.00E+00 -1.82E-02
   8 3.96723E-01 5.544E-02 0.000E+00 1.645E-01 1.855E-03  0.00E+00  0.00E+00  1.75E-02
   9 4.54145E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  10 4.60223E-01 9.496E-02 2.849E-01 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  11 4.85218E-01 2.362E-01 7.085E-01 0.000E+00 0.000E+00 -5.54E-06  0.00E+00  0.00E+00
  12 4.93405E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  13 5.04250E-01 5.802E-04 0.000E+00 2.037E-05 1.720E-03  0.00E+00  0.00E+00 -1.87E-04
  14 5.04368E-01 4.018E-04 0.000E+00 1.191E-03 1.454E-05  0.00E+00  0.00E+00  1.32E-04
  15 5.20481E-01 6.932E-02 0.000E+00 2.332E-03 2.056E-01  0.00E+00  2.23E-06 -2.19E-02
  16 5.22450E-01 1.495E-01 0.000E+00 4.434E-01 5.039E-03 -3.41E-06  0.00E+00  4.73E-02
  17 5.36114E-01 1.674E-01 0.000E+00 5.653E-03 4.965E-01  0.00E+00  4.99E-06 -5.30E-02
  18 5.42854E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  19 5.42854E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  20 5.63730E-01 3.349E-01 0.000E+00 9.934E-01 1.132E-02  8.90E-06  0.00E+00  1.06E-01
  21 5.64256E-01 4.170E-01 0.000E+00 1.409E-02 1.237E+00  0.00E+00 -8.55E-06 -1.32E-01
  22 5.71468E-01 2.664E-02 7.992E-02 0.000E+00 0.000E+00  1.26E-06  0.00E+00  0.00E+00
  23 5.92234E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  24 6.02747E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  25 6.15796E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  26 6.35784E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  27 6.58230E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  28 6.98075E-01 9.565E-01 2.869E+00 0.000E+00 0.000E+00 -6.24E-06 -1.10E-06  0.00E+00
  29 1.01314E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  30 1.02448E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  31 1.02458E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  32 1.13008E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  33 1.16235E+00 8.711E-03 2.613E-02 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  34 1.16736E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  35 1.21643E+00 2.074E-05 0.000E+00 0.000E+00 6.152E-05  0.00E+00  0.00E+00 -6.57E-06
  Sum of osc. strength :     2.575013E+00
  Cauchy coeffs (au) : ( -2)-&gt;  7.974E+00, ( -4)-&gt;  2.764E+01, ( -6)-&gt;  1.074E+02
    (-8)-&gt;  4.656E+02, (-10)-&gt;  2.225E+03, (-12)-&gt;  1.153E+04, (-14)-&gt;  6.364E+04

  TDDFT triplet excitation energies (at most 20 of them are printed),
  and corresponding total energies.                
  Excit#   (Ha)    and    (eV)    total energy (Ha)    major contributions
   1    2.88423E-01   7.84838E+00   -1.929652E+01    0.82(  5-&gt;  6)  0.18(  5-&gt;  7)
   2    2.88424E-01   7.84842E+00   -1.929652E+01    0.82(  5-&gt;  7)  0.18(  5-&gt;  6)
   3    2.99762E-01   8.15693E+00   -1.928518E+01    0.37(  3-&gt;  6)  0.37(  4-&gt;  7)
   4    3.33749E-01   9.08177E+00   -1.925119E+01    0.37(  4-&gt;  6)  0.37(  3-&gt;  7)
   5    3.33809E-01   9.08339E+00   -1.925113E+01    0.37(  4-&gt;  7)  0.37(  3-&gt;  6)
   6    3.36922E-01   9.16812E+00   -1.924802E+01    1.00(  5-&gt;  8)  0.00(  2-&gt; 10)
   7    3.64202E-01   9.91045E+00   -1.922074E+01    0.37(  3-&gt;  7)  0.37(  4-&gt;  6)
   8    3.90779E-01   1.06336E+01   -1.919416E+01    0.67(  3-&gt;  8)  0.27(  2-&gt;  6)
   9    3.90834E-01   1.06351E+01   -1.919411E+01    0.67(  4-&gt;  8)  0.27(  2-&gt;  7)
  10    4.01611E-01   1.09284E+01   -1.918333E+01    0.56(  2-&gt;  6)  0.32(  3-&gt;  8)
  11    4.01627E-01   1.09288E+01   -1.918331E+01    0.56(  2-&gt;  7)  0.32(  4-&gt;  8)
  12    4.49961E-01   1.22441E+01   -1.913498E+01    1.00(  5-&gt;  9)  0.00(  2-&gt; 10)
  13    4.56640E-01   1.24258E+01   -1.912830E+01    0.97(  2-&gt;  8)  0.03(  5-&gt; 10)
  14    4.84251E-01   1.31771E+01   -1.910069E+01    0.97(  5-&gt; 10)  0.03(  2-&gt;  8)
  15    4.95485E-01   1.34828E+01   -1.908945E+01    1.00(  5-&gt; 11)  0.00(  3-&gt; 12)
  16    5.05047E-01   1.37430E+01   -1.907989E+01    0.98(  3-&gt;  9)  0.02(  4-&gt;  9)
  17    5.05050E-01   1.37431E+01   -1.907989E+01    0.98(  4-&gt;  9)  0.02(  3-&gt;  9)
  18    5.36189E-01   1.45904E+01   -1.904875E+01    1.00(  5-&gt; 12)  0.00(  3-&gt; 11)
  19    5.39866E-01   1.46905E+01   -1.904507E+01    0.99(  3-&gt; 10)  0.01(  4-&gt; 10)
  20    5.39928E-01   1.46922E+01   -1.904501E+01    0.99(  4-&gt; 10)  0.01(  3-&gt; 10)

  Oscillator strengths :  (elements smaller than 1.e-6 are set to zero)
  Excit#   (Ha)   Average    XX        YY        ZZ         XY        XZ        YZ
   1 2.88423E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   2 2.88424E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   3 2.99762E-01 1.120E+00 3.361E+00 0.000E+00 0.000E+00  0.00E+00 -1.24E-05  0.00E+00
   4 3.33749E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   5 3.33809E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   6 3.36922E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   7 3.64202E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   8 3.90779E-01 2.627E-02 0.000E+00 8.586E-04 7.794E-02  0.00E+00  0.00E+00 -8.18E-03
   9 3.90834E-01 2.852E-02 0.000E+00 8.463E-02 9.356E-04  0.00E+00  0.00E+00  8.90E-03
  10 4.01611E-01 3.662E-01 0.000E+00 1.287E-02 1.086E+00  0.00E+00  3.30E-06 -1.18E-01
  11 4.01627E-01 3.626E-01 0.000E+00 1.075E+00 1.275E-02  0.00E+00  0.00E+00  1.17E-01
  12 4.49961E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  13 4.56640E-01 5.447E-03 1.634E-02 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  14 4.84251E-01 1.453E-01 4.359E-01 0.000E+00 0.000E+00 -4.96E-06  0.00E+00  0.00E+00
  15 4.95485E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  16 5.05047E-01 5.809E-02 0.000E+00 2.615E-03 1.716E-01  0.00E+00  0.00E+00 -2.12E-02
  17 5.05050E-01 5.723E-02 0.000E+00 1.691E-01 2.585E-03  0.00E+00  0.00E+00  2.09E-02
  18 5.36189E-01 1.842E-01 0.000E+00 6.221E-03 5.465E-01  0.00E+00  7.75E-06 -5.83E-02
  19 5.39866E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  20 5.39928E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  21 5.48655E-01 9.182E-02 0.000E+00 2.724E-01 3.101E-03  1.07E-06  0.00E+00  2.91E-02
  22 5.48701E-01 7.682E-02 0.000E+00 2.594E-03 2.279E-01  0.00E+00 -1.43E-06 -2.43E-02
  23 5.71153E-01 5.133E-02 1.540E-01 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  24 5.88211E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  25 5.91619E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  26 6.03715E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  27 6.15373E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  28 6.56161E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  29 9.58189E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  30 9.58215E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  31 1.01025E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  32 1.11959E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  33 1.15532E+00 3.922E-04 1.177E-03 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  34 1.16498E+00 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  35 1.20489E+00 2.435E-04 0.000E+00 8.222E-06 7.224E-04  0.00E+00  0.00E+00 -7.71E-05
  Sum of osc. strength :     2.575013E+00

--- !ResultsGS
iteration_state: {dtset: 2, }
comment   : Summary of ground state results
lattice_vectors:
- [ 11.3383568,   0.0000000,   0.0000000, ]
- [  0.0000000,   9.4486307,   0.0000000, ]
- [  0.0000000,   0.0000000,   9.4486307, ]
lattice_lengths: [  11.33836,    9.44863,    9.44863, ]
lattice_angles: [ 90.000,  90.000,  90.000, ] # degrees, (23, 13, 12)
lattice_volume:   1.0122502E+03
convergence: {deltae:  0.000E+00, res2:  0.000E+00, residm:  6.996E-10, diffor:  0.000E+00, }
etotal    :  -1.95849394E+01
entropy   :   0.00000000E+00
fermie    :  -3.29296197E-01
cartesian_stress_tensor: null
pressure_GPa: null
xred      :
- [ -9.1475E-02,   0.0000E+00,   0.0000E+00,  N]
- [  9.1475E-02,   0.0000E+00,   0.0000E+00,  N]
cartesian_forces: null
force_length_stats: {min: null, max: null, mean: null, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          5.78852189
    2        2.00000          5.78852189
================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   27.909E-11; max=  69.963E-11
 reduced coordinates (array xred) for    2 atoms
      -0.091475000000      0.000000000000      0.000000000000
       0.091475000000      0.000000000000      0.000000000000

 cartesian coordinates (angstrom) at end:
    1     -0.54885000000000     0.00000000000000     0.00000000000000
    2      0.54885000000000     0.00000000000000     0.00000000000000
 length scales= 11.338356797314  9.448630664428  9.448630664428 bohr
              =  6.000000000000  5.000000000000  5.000000000000 angstroms
 prteigrs : about to open file ttddft_1o_DS2_EIG
 Eigenvalues (hartree) for nkpt=   1  k points:
 kpt#   1, nband= 12, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced coord)
  -0.99636   -0.44764   -0.38261   -0.38261   -0.32930   -0.01841   -0.01841    0.01474
   0.12529    0.15992    0.16973    0.21155

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      1.1338356797E+01  9.4486306644E+00  9.4486306644E+00 Bohr
              amu      1.40067400E+01
        boxcenter      0.00000000E+00  0.00000000E+00  0.00000000E+00
           diecut1     2.20000000E+00 Hartree
           diecut2     1.00000000E+02 Hartree
           diemac      1.00000000E+00
           diemix      5.00000000E-01
             ecut      2.50000000E+01 Hartree
           etotal1    -1.9584939407E+01
            fcart1    -2.8284404509E-02 -0.0000000000E+00 -0.0000000000E+00
                       2.8284404509E-02 -0.0000000000E+00 -0.0000000000E+00
-          fftalg         312
           getden1          0
           getden2          1
           getwfk1          0
           getwfk2          1
             iscf1          7
             iscf2         -1
           istwfk        2
              ixc           7
           jdtset        1    2
           kptopt           0
P           mkmem           1
            natom           2
            nband1          5
            nband2         12
           ndtset           2
            ngfft          54      45      45
             nkpt           1
            nstep          25
             nsym          16
           ntypat           1
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
          spgroup         123
           strten1     4.0132949247E-04  4.5408486206E-04  4.5408486206E-04
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                      -1  0  0   0 -1  0   0  0  1       1  0  0   0  1  0   0  0 -1
                       1  0  0   0 -1  0   0  0 -1      -1  0  0   0  1  0   0  0  1
                      -1  0  0   0  1  0   0  0 -1       1  0  0   0 -1  0   0  0  1
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                      -1  0  0   0  0 -1   0  1  0       1  0  0   0  0  1   0 -1  0
                       1  0  0   0  0 -1   0 -1  0      -1  0  0   0  0  1   0  1  0
                      -1  0  0   0  0  1   0 -1  0       1  0  0   0  0 -1   0  1  0
           tolwfr1     1.00000000E-15
           tolwfr2     1.00000000E-09
            typat      1  1
           xangst     -5.4885000000E-01  0.0000000000E+00  0.0000000000E+00
                       5.4885000000E-01  0.0000000000E+00  0.0000000000E+00
            xcart     -1.0371761880E+00  0.0000000000E+00  0.0000000000E+00
                       1.0371761880E+00  0.0000000000E+00  0.0000000000E+00
             xred     -9.1475000000E-02  0.0000000000E+00  0.0000000000E+00
                       9.1475000000E-02  0.0000000000E+00  0.0000000000E+00
            znucl        7.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- [3] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- And optionally:
-
- [4] A brief introduction to the ABINIT software package.
- Z. Kristallogr. 220, 558-562 (2005).
- X. Gonze, G.-M. Rignanese, M. Verstraete, J.-M. Beuken, Y. Pouillon, R. Caracas, F. Jollet,
- M. Torrent, G. Zerah, M. Mikami, Ph. Ghosez, M. Veithen, J.-Y. Raty, V. Olevano, F. Bruneval,
- L. Reining, R. Godby, G. Onida, D.R. Hamann, and D.C. Allan.
- Comment: the second generic paper describing the ABINIT project. Note that this paper
- should be cited especially if you are using the GW part of ABINIT, as several authors
- of this part are not in the list of authors of the first or third paper.
- The .pdf of the latter paper is available at https://www.abinit.org/sites/default/files/zfk_0505-06_558-562.pdf.
- Note that it should not redistributed (Copyright by Oldenburg Wissenschaftverlag,
- the licence allows the authors to put it on the Web).
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2005
-
- Proc.   0 individual time (sec): cpu=          3.4  wall=          5.5

================================================================================

 Calculation completed.
.Delivered   7 WARNINGs and   3 COMMENTs to log file.
+Overall time at end (sec) : cpu=          3.4  wall=          5.5

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5f1f3dcb-d93d-492d-a24b-041fe2b42964", "#uuid-a4353d8b-a937-486d-a7d1-be4b7deddce9") }); </script>

<p>One can jump to the second dataset section, and skip a few non-interesting
information, in order to reach the following information:</p>
<div class="codehilite"><pre><span></span> *** TDDFT : computation of excited states ***
 Splitting of  12 bands in   5 occupied bands, and   7 unoccupied bands,
 giving    35 excitations.
</pre></div>


<p>The matrix that is diagonalized, in the Casida&rsquo;s formalism, is thus a 35x35 matrix.
It will give 35 excitation energies.
Then, follows the list of excitation energies, obtained from the difference of
Kohn-Sham eigenvalues (occupied and unoccupied), for further reference. They
are ordered by increasing energy. In order to analyze the TDDFT as well as
experimental data in the next section, let us mention that the Kohn-Sham
eigenfunctions in this simulation have the following characteristics:</p>
<ul>
<li>The first and fifth states are (non-degenerate) occupied <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> states (m=0), with even parity</li>
<li>The second state is a (non-degenerate) occupied <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> state (m=0), with odd parity</li>
<li>The third and fourth states are degenerate occupied <span><span class="MathJax_Preview">\pi</span><script type="math/tex">\pi</script></span> states (m=+1,-1), with odd parity</li>
<li>The sixth and seventh states are degenerate unoccupied <span><span class="MathJax_Preview">\pi</span><script type="math/tex">\pi</script></span> states (m=+1,-1), with even parity</li>
<li>The state 8 is a (non-degenerate) unoccupied <span><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> state (m=0), with even parity</li>
</ul>
<p>Combining states 3,4 and 5 with 6, 7 and 8, give the first nine Kohn-Sham energy differences:</p>
<div class="codehilite"><pre><span></span>  Transition  (Ha)  and   (eV)   Tot. Ene. (Ha)  Aver     XX       YY       ZZ
   5-&gt;  6 3.10888E-01 8.45969E+00 -1.92741E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   5-&gt;  7 3.10888E-01 8.45969E+00 -1.92741E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   5-&gt;  8 3.44036E-01 9.36171E+00 -1.92409E+01 0.0000E+00 0.00E+00 0.00E+00 0.00E+00
   4-&gt;  6 3.64203E-01 9.91046E+00 -1.92207E+01 1.4463E-01 4.34E-01 0.00E+00 0.00E+00
   3-&gt;  6 3.64203E-01 9.91046E+00 -1.92207E+01 4.2299E-01 1.27E+00 0.00E+00 0.00E+00
   4-&gt;  7 3.64203E-01 9.91046E+00 -1.92207E+01 4.2299E-01 1.27E+00 0.00E+00 0.00E+00
   3-&gt;  7 3.64203E-01 9.91046E+00 -1.92207E+01 1.4463E-01 4.34E-01 0.00E+00 0.00E+00
   4-&gt;  8 3.97351E-01 1.08125E+01 -1.91876E+01 4.0028E-02 0.00E+00 1.20E-01 0.00E+00
   3-&gt;  8 3.97351E-01 1.08125E+01 -1.91876E+01 4.0028E-02 0.00E+00 0.00E+00 1.20E-01
</pre></div>


<p>Without the coupling matrix, these would be the excitation energies, for both
the spin-singlet and spin-triplet states. The coupling matrix modifies the
eigenenergies, by mixing different electronic excitations, and also lift some
degeneracies, e.g. the quadruplet formed by the combination of the degenerate
states 3-4 and 6-7 that gives the excitation energies with 3.64203E-01 Ha in the above table.</p>
<p>Indeed, concerning the spin-singlet, the following excitation energies are
obtained (see the next section of the output file):</p>
<div class="codehilite"><pre><span></span>  TDDFT singlet excitation energies (at most 20 of them are printed),
  and corresponding total energies.
  Excit#   (Ha)    and    (eV)    total energy (Ha)    major contributions
   1    3.47952E-01   9.46826E+00   -1.923699E+01    0.83(  5-&gt;  6)  0.17(  5-&gt;  7)
   2    3.48006E-01   9.46971E+00   -1.923693E+01    0.83(  5-&gt;  7)  0.17(  5-&gt;  6)
   3    3.62425E-01   9.86208E+00   -1.922251E+01    0.99(  5-&gt;  8)  0.00(  2-&gt; 10)
   4    3.64202E-01   9.91043E+00   -1.922074E+01    0.37(  3-&gt;  7)  0.37(  4-&gt;  6)
   5    3.84223E-01   1.04553E+01   -1.920072E+01    0.37(  4-&gt;  6)  0.37(  3-&gt;  7)
   6    3.84236E-01   1.04556E+01   -1.920070E+01    0.37(  4-&gt;  7)  0.37(  3-&gt;  6)
   7    3.96699E-01   1.07947E+01   -1.918824E+01    0.99(  3-&gt;  8)  0.01(  4-&gt;  8)
   8    3.96723E-01   1.07954E+01   -1.918822E+01    0.99(  4-&gt;  8)  0.01(  3-&gt;  8)
   9    4.54145E-01   1.23579E+01   -1.913079E+01    1.00(  5-&gt;  9)  0.00(  3-&gt; 12)
   ...
</pre></div>


<p>The excitation energies are numbered according to increasing energies, in Ha
as well as in eV. The total energy is also given (adding excitation energy to
the ground-state energy), and finally, the two major contributions to each
of these excitations are mentioned (size of the contribution then identification).</p>
<p>It is seen that the first and second excitations are degenerate (numerical
inaccuracies accounts for the meV difference), and mainly comes from the first
and second Kohn-Sham energy differences (between occupied state 5 and
unoccupied states 6 and 7). This is also true for the third excitation, that
comes from the third Kohn-Sham energy difference (between occupied state 5 and
unoccupied state 8). The quadruplet of Kohn-Sham energy differences, that was
observed at 3.64203E-01 Ha, has been split into one doublet and two singlets,
with numbers 4 (the lowest singlet), 5-6 (the doublet) while the last singlet
is not present in the 20 lowest excitations.</p>
<p>The list of oscillator strength is then provided.</p>
<div class="codehilite"><pre><span></span>  Oscillator strengths :  (elements smaller than 1.e-6 are set to zero)
  Excit#   (Ha)   Average    XX        YY        ZZ         XY        XZ        YZ
   1 3.47952E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   2 3.48006E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   3 3.62425E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   4 3.64202E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   5 3.84223E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   6 3.84236E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   7 3.96699E-01 5.759E-02 0.000E+00 1.928E-03 1.709E-01  0.00E+00  0.00E+00 -1.82E-02
   8 3.96723E-01 5.544E-02 0.000E+00 1.645E-01 1.855E-03  0.00E+00  0.00E+00  1.75E-02
   9 4.54145E-01 0.000E+00 0.000E+00 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
  10 4.60223E-01 9.496E-02 2.849E-01 0.000E+00 0.000E+00  0.00E+00  0.00E+00  0.00E+00
   ...
</pre></div>


<p>The first six transitions are forbidden, with zero oscillator strength. The
seventh and eighth transitions are allowed, with sizeable YY, YZ and ZZ components.</p>
<p>Next, one finds the excitation energies for the spin-triplet states:</p>
<div class="codehilite"><pre><span></span>  TDDFT triplet excitation energies (at most 20 of them are printed),
  and corresponding total energies.
  Excit#   (Ha)    and    (eV)    total energy (Ha)    major contributions
   1    2.88423E-01   7.84838E+00   -1.929652E+01    0.82(  5-&gt;  6)  0.18(  5-&gt;  7)
   2    2.88424E-01   7.84842E+00   -1.929652E+01    0.82(  5-&gt;  7)  0.18(  5-&gt;  6)
   3    2.99762E-01   8.15693E+00   -1.928518E+01    0.37(  3-&gt;  6)  0.37(  4-&gt;  7)
   4    3.33749E-01   9.08177E+00   -1.925119E+01    0.37(  4-&gt;  6)  0.37(  3-&gt;  7)
   5    3.33809E-01   9.08339E+00   -1.925113E+01    0.37(  4-&gt;  7)  0.37(  3-&gt;  6)
   6    3.36922E-01   9.16812E+00   -1.924802E+01    1.00(  5-&gt;  8)  0.00(  2-&gt; 10)
   7    3.64202E-01   9.91045E+00   -1.922074E+01    0.37(  3-&gt;  7)  0.37(  4-&gt;  6)
   8    3.90779E-01   1.06336E+01   -1.919416E+01    0.67(  3-&gt;  8)  0.27(  2-&gt;  6)
   9    3.90834E-01   1.06351E+01   -1.919411E+01    0.67(  4-&gt;  8)  0.27(  2-&gt;  7)
   ...
</pre></div>


<p>Spin-triplet energies are markedly lower than the corresponding spin-singlet
energies. Also, the highest singlet derived from the Kohn-Sham quadruplet is
now the excitation number 7. The oscillator strengths also follow. At this
stage, we are in position to compare with experimental data, and try to
improve the quality of our calculation.</p>
<p>To summarize our results, we obtain the following five lowest-lying spin-
singlet excitation energies, with corresponding quantum numbers (that we
derive from the knowledge of the Kohn-Sham states quantum numbers):</p>
<div class="codehilite"><pre><span></span>9.47 eV   m=+1,-1  even parity (Pi_g state)
9.86 eV   m=0      even parity (Sigma_g state)
9.91 eV   m=0      odd parity  (Sigma_u state)
10.46 eV  m=+2,-2  odd parity  (Delta_u state)
10.79 eV  m=+1,-1  odd parity  (Pi_u state)
</pre></div>


<p>and the following five lowest-lying spin-triplet excitations energies, with
corresponding quantum numbers:</p>
<div class="codehilite"><pre><span></span>7.85 eV   m=+1,-1  even parity (Pi_g state)
8.16 eV   m=0      odd parity  (Sigma_u state)
9.08 eV   m=+2,-2  odd parity  (Delta_u state)
9.16 eV   m=0      even parity (Sigma_g state)
9.91 eV   m=0      odd parity  (Sigma_u state)
</pre></div>


<p>The quantum number related to the effect of a mirror plane, needed for <span><span class="MathJax_Preview">\Sigma</span><script type="math/tex">\Sigma</script></span>
states, could not be attributed on the sole basis of the knowledge of Kohn-
Sham orbitals quantum numbers.</p>
<p>The lowest-lying experimental spin-singlet excitation energies, see table III
of <a class="wikilink citation-wikilink" data-content="Molecular excitation energies to high-lying bound states from time-dependent density-functional response theory: Characterization and correction of the time-dependent local density approximation ionization threshold" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#casida1998">[Casida1998]</a>, are as follows:</p>
<div class="codehilite"><pre><span></span>9.31 eV   m=+1,-1  even parity (Pi_g state)
9.92 eV   m=0      odd parity  (Sigma_u- state)
10.27 eV  m=+2,-2  odd parity  (Delta_u state)
</pre></div>


<p>and the lowest-lying experimental spin-triplet excitations energies are:</p>
<div class="codehilite"><pre><span></span>7.75 eV   m=0      odd parity  (Sigma_u+ state)
8.04 eV   m=+1,-1  even parity (Pi_g state)
8.88 eV   m=+2,-2  odd parity  (Delta_u state)
9.67 eV   m=0      odd parity  (Sigma_u- state)
</pre></div>


<p>In several cases, the agreement is quite satisfactory, on the order of 0.1-0.2
eV. However, there are also noticeable discrepancies. Indeed, we have to understand, in our simulation:</p>
<ul>
<li>The appearance of the spin-singlet <span><span class="MathJax_Preview">^1\Sigma_g</span><script type="math/tex">^1\Sigma_g</script></span> state at 9.86 eV (Spin-singlet state 2)</li>
<li>The inversion between the spin-triplet <span><span class="MathJax_Preview">^3\Pi_g</span><script type="math/tex">^3\Pi_g</script></span> and <span><span class="MathJax_Preview">^3\Sigma_u</span><script type="math/tex">^3\Sigma_u</script></span> states (Spin-triplet states 1 and 2)</li>
<li>The appearance of the spin-triplet <span><span class="MathJax_Preview">^3\Sigma_g</span><script type="math/tex">^3\Sigma_g</script></span> state at 9.16 eV (Spin-triplet state 4)</li>
</ul>
<p>Still, the agreement between these TDDFT values and the experimental values is
much better than anything that can be done on the sole basis of Kohn-Sham
energy differences, that are (for spin-singlet and -triplet):</p>
<div class="codehilite"><pre><span></span>8.46 eV   m=+1,-1   even parity (Pi_g state)
9.36 eV   m=0       odd parity  (Sigma_u state)
9.91 eV   m=0(twice),+2,-2 odd parity  (Sigma_u and Delta_u states)
10.81 eV  m=+1,-1   odd parity  (Pi_u state)
</pre></div>


<h2 id="convergence-studies">Convergence studies<a class="headerlink" href="#convergence-studies" title="Permanent link">&para;</a></h2>
<p>There are several parameters subject to convergence studies in this context:
the energy cut-off, the box size, and the number of unoccupied bands.</p>
<p>We will start with the number of unoccupied states. The only input parameter
to be changed in the input file is the value of nband2. The following results
are obtained, for nband2 = 12, 30, 60, 100 and 150 (Energies given in eV):</p>
<div class="codehilite"><pre><span></span>Singlet 1 :  9.47   9.44   9.39   9.36   9.35
Singlet 2 :  9.86   9.74   9.68   9.66   9.66
Singlet 3 :  9.91   9.91   9.91   9.91   9.91
Singlet 4 : 10.46  10.45  10.44  10.44  10.43
Singlet 5 : 10.79  10.79  10.79  10.79  10.79
Triplet 1 :  7.85   7.84   7.83   7.82   7.82
Triplet 2 :  8.16   8.08   8.03   8.00   8.00
Triplet 3 :  9.08   9.07   9.05   9.05   9.04
Triplet 4 :  9.16   9.16   9.15   9.15   9.15
Triplet 5 :  9.91   9.91   9.91   9.91   9.91
</pre></div>


<p>You might try to obtain one of these&hellip;</p>
<p>The computation with nband2 = 100 takes
about 7 minutes on a 2.8 GHz PC, and gives a result likely converged within
0.01 eV. Let&rsquo;s have a look at these data. Unfortunately, none of the above-
mentioned discrepancies with experimental data is resolved, although the
difference between the first and second spin-triplet states decreases
significantly. Although we see that at least 60 bands are needed to obtain
results converged within 0.05 eV, we will continue to rely on 12 bands to try
to understand the most important discrepancies, while keeping the CPU time to a low level.</p>
<p>We next try to increase the cut-off energy. Again, this is fairly easy. One
can e.g. set up a double dataset loop. The following results are obtained, for
ecut = 25, 35, 45, 55, 65, and 75 Ha:</p>
<div class="codehilite"><pre><span></span>Singlet 1 :  9.47   9.41   9.39   9.36   9.36
Singlet 2 :  9.86   9.83   9.78   9.76   9.76
Singlet 3 :  9.91   9.97  10.01  10.02  10.03
Singlet 4 : 10.46  10.37  10.32  10.30  10.29
Singlet 5 : 10.79  10.87  10.90  10.91  10.92
Triplet 1 :  7.85   7.79   7.76   7.74   7.73
Triplet 2 :  8.16   8.02   7.94   7.92   7.91
Triplet 3 :  9.08   8.98   8.92   8.90   8.89
Triplet 4 :  9.16   9.28   9.33   9.34   9.34
Triplet 5 :  9.91   9.83   9.78   9.77   9.76
</pre></div>


<p>You might try to obtain one of these&hellip;</p>
<p>The computation with ecut=75 takes
about 90 secs on a 2.8 GHz PC, and gives a result likely converged within 0.01
eV. Let us have a look at these data. Concerning the discrepancies with the
experimental results, we see that the position of the second spin-singlet
state has even worsened, the difference between the first and second spin-
triplet states decreases, so that, together with an increase of nband, their
order might become the correct one, and the fourth spin-triplet state energy
has increased, but not enough.</p>
<p>We finally examine the effect of the cell size. Again, this is fairly easy.
One can e.g. set up a double dataset loop. The following results are obtained,
for acell = (6 5 5), (7 6 6), (8 7 7), (9 8 8), (10 9 9) and (12 11 11):</p>
<div class="codehilite"><pre><span></span>Singlet 1 :  9.47   9.37   9.33   9.33   9.33   9.33
Singlet 2 :  9.86   9.78   9.84   9.91   9.96  10.03
Singlet 3 :  9.91   9.88   9.85   9.85   9.85   9.85
Singlet 4 : 10.46  10.41  10.38  10.37  10.37  10.37
Singlet 5 : 10.79  10.98  11.14  11.27  11.19  11.04
Triplet 1 :  7.85   7.75   7.72   7.71   7.72   7.72
Triplet 2 :  8.16   8.18   8.18   8.18   8.19   8.20
Triplet 3 :  9.08   9.07   9.06   9.06   9.06   9.06
Triplet 4 :  9.16   9.36   9.55   9.68   9.78   9.90
Triplet 5 :  9.91   9.88   9.85   9.85   9.85   9.85
</pre></div>


<p>Obviously, the cell size plays an important role in the spurious appearance of
the states, that was remarked when comparing against experimental data.
Indeed, the singlet 2 and triplet 4 states energy increases strongly with the
cell size, while all other states quickly stabilize (except the still higher singlet 5 state).</p>
<p>There is one lesson to be learned from that convergence study: the
convergence of different states can be quite different. Usually, converging
the lower excited states do not require too much effort, while it is quite
difficult, especially concerning the supercell size, to converge higher states.</p>
<p>At this stage, we will simply stop this convergence study, and give the
results of an ABINIT calculation using ecut 45 Hartree, acell 12 11 11, and 30
bands (not fully converged, though!), then compare the results with other
LDA/TDLDA results (from <a class="wikilink citation-wikilink" data-content="Molecular excitation energies to high-lying bound states from time-dependent density-functional response theory: Characterization and correction of the time-dependent local density approximation ionization threshold" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#casida1998">[Casida1998]</a>) and experimental results:</p>
<div class="codehilite"><pre><span></span>                      present Casida experimental
Singlet Pi_g      :  9.25    9.05     9.31
Singlet Sigma_u-  :  9.72    9.63     9.92
Singlet Delta_u   : 10.22   10.22    10.27
Triplet Sigma_u+  :  7.95    7.85     7.75
Triplet Pi_g      :  7.64    7.54     8.04
Triplet Delta_u   :  8.89    8.82     8.88
Triplet Sigma_u-  :  9.72    9.63     9.67
</pre></div>


<p>Our calculation is based on pseudopotentials, while Casida&rsquo;s calculation is an
all-electron one. This fact might account for the 0.1-0.2 eV discrepancy
between both calculations (it is of course the user&rsquo;s responsibility to test
the influence of different pseudopotentials on his/her calculations). The
agreement with experimental data is on the order of 0.2 eV, with the exception
of the <span><span class="MathJax_Preview">^3\Pi_g</span><script type="math/tex">^3\Pi_g</script></span> state (0.4 eV). In particular, we note that LDA/TDLDA is
not able to get the correct ordering of the lower two triplet states &hellip; One
of our problems was intrinsic to the LDA/TDLDA approximation &hellip;</p>
<h2 id="the-choice-of-the-exchange-correlation-potential">The choice of the exchange-correlation potential<a class="headerlink" href="#the-choice-of-the-exchange-correlation-potential" title="Permanent link">&para;</a></h2>
<p>As emphasized in <a class="wikilink citation-wikilink" data-content="Molecular excitation energies to high-lying bound states from time-dependent density-functional response theory: Characterization and correction of the time-dependent local density approximation ionization threshold" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#casida1998">[Casida1998]</a>, choosing a different functional for the self-consistent part
(XC potential) and the generation of the coupling matrix (XC
kernel) can give a better description of the higher-lying states. Indeed, a
potential with a -1/r tail (unlike the LDA or GGA) like the van Leeuwen-Baerends one <a class="wikilink citation-wikilink" data-content="Exchange-correlation potential with correct asymptotic behavior" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#vanleeuwen1994">[VanLeeuwen1994]</a>,
can reproduce fairly well the ionisation energy, giving a much
better description of the Rydberg states. Still, the LDA kernel works pretty well.</p>
<p>In order to activate this procedure, set the value of <a class="wikilink codevar-wikilink" href="../../variables/basic#ixc">ixc</a> in dataset 1 to the
SCF functional, and the value of ixc in dataset 2 to the XC functional to be
used for the kernel. Use pseudopotentials that agree with the SCF functional.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/git_and_gitlab/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Tutorial"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../positron/" title="Positron" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Positron
              </span>
            </div>
          </a>
        
        
          <a href="../wannier90/" title="Wannier90" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Wannier90
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.2.2</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group (XG)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>