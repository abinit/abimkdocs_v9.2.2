



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="https://docs.abinit.org/tutorial/paral_gspw/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.6.6">
    
    
      
        <title>Parallelization of ground state</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#parallelization-of-ground-state-calculations" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.abinit.org" title="abinit" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-abinit-2015.png" width="48" height="48">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Tutorial
                </span>
              
                <span class="md-header-nav__parent">
                  Parallelism
                </span>
              
            
            GSPW
          
        </span>
      </div>
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            9.2.2
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo-abinit-2015.png" width="24" height="24">
      
    </span>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/spacegroup/" title="Spacegroup" class="md-nav__link">
      Spacegroup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/a-TDEP/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-14" type="checkbox" id="nav-1-14">
    
    <label class="md-nav__link" for="nav-1-14">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-14">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="HowTo" class="md-nav__link">
      HowTo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_MacOS/" title="MacOS" class="md-nav__link">
      MacOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_Ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_CentOS/" title="CentOS" class="md-nav__link">
      CentOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_EasyBuild/" title="EasyBuild" class="md-nav__link">
      EasyBuild
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../INSTALL_gpu/" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BoundingProcess/" title="BoundingProcess" class="md-nav__link">
      BoundingProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedDFT/" title="ConstrainedDFT" class="md-nav__link">
      ConstrainedDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CrossingBarriers/" title="CrossingBarriers" class="md-nav__link">
      CrossingBarriers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DynamicsMultibinit/" title="DynamicsMultibinit" class="md-nav__link">
      DynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffectiveMass/" title="EffectiveMass" class="md-nav__link">
      EffectiveMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FileFormats/" title="FileFormats" class="md-nav__link">
      FileFormats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FitProcess/" title="FitProcess" class="md-nav__link">
      FitProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LatticeModel/" title="LatticeModel" class="md-nav__link">
      LatticeModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LDAminushalf/" title="LDAminushalf" class="md-nav__link">
      LDAminushalf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/longwave/" title="Longwave" class="md-nav__link">
      Longwave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Macroave/" title="Macroave" class="md-nav__link">
      Macroave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SpinDynamicsMultibinit/" title="SpinDynamicsMultibinit" class="md-nav__link">
      SpinDynamicsMultibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/a-TDEP/" title="a TDEP" class="md-nav__link">
      a TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/multibinit/" title="Multibinit" class="md-nav__link">
      Multibinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/atdep/" title="a-TDEP" class="md-nav__link">
      a-TDEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compilation/" title="Building Abinit" class="md-nav__link">
      Building Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph_intro/" title="Eph intro" class="md-nav__link">
      Eph intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4mob/" title="Eph4mob" class="md-nav__link">
      Eph4mob
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph4zpr/" title="Eph4zpr" class="md-nav__link">
      Eph4zpr
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      EPH-legacy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        EPH-legacy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11" checked>
    
    <label class="md-nav__link" for="nav-4-11">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        GSPW
      </label>
    
    <a href="./" title="GSPW" class="md-nav__link md-nav__link--active">
      GSPW
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#explore-the-k-pointsplane-wavesbands-parallelization" title="Explore the k-points/plane waves/bands parallelization" class="md-nav__link">
    Explore the k-points/plane waves/bands parallelization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-introduction" title="1 Introduction" class="md-nav__link">
    1 Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-a-simple-way-to-begin-automatic-distributed-parallelism" title="2 A simple way to begin: automatic distributed parallelism" class="md-nav__link">
    2 A simple way to begin: automatic distributed parallelism
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-a-more-sophisticated-method" title="3 A more sophisticated method" class="md-nav__link">
    3 A more sophisticated method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-even-more-sophisticated-bands-per-process-bandpp" title="4 Even more sophisticated: BANDs Per Process (bandpp)" class="md-nav__link">
    4 Even more sophisticated: BANDs Per Process (bandpp)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-hybrid-parallelism-mpiopenmp" title="5 Hybrid parallelism: MPI+openMP" class="md-nav__link">
    5 Hybrid parallelism: MPI+openMP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-the-kgb-parallelization" title="6 The KGB parallelization" class="md-nav__link">
    6 The KGB parallelization
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      Multibinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        Multibinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../lattice_model/" title="Lattice Model" class="md-nav__link">
      Lattice Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin_model/" title="Spin Model" class="md-nav__link">
      Spin Model
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/geometry/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/spherical_harmonics/" title="Spherical Harmonics" class="md-nav__link">
      Spherical Harmonics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/noncollinear/" title="Noncollinear" class="md-nav__link">
      Noncollinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/pseudopotentials/" title="Pseudopotentials" class="md-nav__link">
      Pseudopotentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/git_and_gitlab/" title="Git and Gitlab" class="md-nav__link">
      Git and Gitlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/developers_howto/" title="HowTo for developers" class="md-nav__link">
      HowTo for developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Test Suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Test Suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test list" class="md-nav__link">
      Test list
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite_howto/" title="Test Suite Howto" class="md-nav__link">
      Test Suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/new_testsuite/" title="YAML-based test suite Howto" class="md-nav__link">
      YAML-based test suite Howto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/yaml_tools_api/" title="YAML-based test suite Python tools and API" class="md-nav__link">
      YAML-based test suite Python tools and API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/XgType/" title="XgType" class="md-nav__link">
      XgType
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      Pseudos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        Pseudos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp1_info/" title="psp1" class="md-nav__link">
      psp1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp3_info/" title="psp3" class="md-nav__link">
      psp3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp45_info/" title="psp45" class="md-nav__link">
      psp45
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp5spinorbit_info/" title="psp5" class="md-nav__link">
      psp5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp6_info/" title="psp6" class="md-nav__link">
      psp6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/psp8_info/" title="psp8" class="md-nav__link">
      psp8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/autoconf_examples/" title="Autoconf_examples" class="md-nav__link">
      Autoconf_examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testlink/" title="Test Page for linkcheck" class="md-nav__link">
      Test Page for linkcheck
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/history/" title="History" class="md-nav__link">
      History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#explore-the-k-pointsplane-wavesbands-parallelization" title="Explore the k-points/plane waves/bands parallelization" class="md-nav__link">
    Explore the k-points/plane waves/bands parallelization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-introduction" title="1 Introduction" class="md-nav__link">
    1 Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-a-simple-way-to-begin-automatic-distributed-parallelism" title="2 A simple way to begin: automatic distributed parallelism" class="md-nav__link">
    2 A simple way to begin: automatic distributed parallelism
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-a-more-sophisticated-method" title="3 A more sophisticated method" class="md-nav__link">
    3 A more sophisticated method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-even-more-sophisticated-bands-per-process-bandpp" title="4 Even more sophisticated: BANDs Per Process (bandpp)" class="md-nav__link">
    4 Even more sophisticated: BANDs Per Process (bandpp)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-hybrid-parallelism-mpiopenmp" title="5 Hybrid parallelism: MPI+openMP" class="md-nav__link">
    5 Hybrid parallelism: MPI+openMP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-the-kgb-parallelization" title="6 The KGB parallelization" class="md-nav__link">
    6 The KGB parallelization
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                  <a href="https://github.com/abinit/abinit/edit/master/doc/tutorial/paral_gspw.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="parallelization-of-ground-state-calculations">Parallelization of ground state calculations<a class="headerlink" href="#parallelization-of-ground-state-calculations" title="Permanent link">&para;</a></h1>
<h2 id="explore-the-k-pointsplane-wavesbands-parallelization">Explore the <em>k-points/plane waves/bands</em> parallelization<a class="headerlink" href="#explore-the-k-pointsplane-wavesbands-parallelization" title="Permanent link">&para;</a></h2>
<p>This tutorial discusses how to perform ground-state calculations on hundreds/thousands
of computing units (CPUs) using ABINIT.</p>
<p>You will learn how to use some keywords related to the &ldquo;KGB&rdquo; parallelization scheme where
&ldquo;K&rdquo; stands for &ldquo;k-point&rdquo;, &ldquo;G&rdquo; refers to the wavevector of a planewave, and &ldquo;B&rdquo; stands for a &ldquo;Band&rdquo;.
It is possible to use ABINIT with other levels of parallelism but this is not the focus of this tutorial.
You will learn how to speedup your calculations and how to improve their convergence rate.</p>
<p>This tutorial should take about 1.5 hour and requires access to at least a 200
CPU core parallel computer.</p>
<p>You are supposed to know already some basics of ABINIT.
Some useful references: <a class="wikilink citation-wikilink" data-content="Parallel eigensolvers in plane-wave Density Functional Theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#levitt2015">[Levitt2015]</a>, <a class="wikilink citation-wikilink" data-content="Large-scale ab initio calculations based on three levels of parallelization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bottin2008">[Bottin2008]</a>, <a class="wikilink citation-wikilink" data-content="Toward the Optimal Preconditioned Eigensolver: Locally Optimal Block Preconditioned Conjugate Gradient Method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#knyazev2001">[Knyazev2001]</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own install of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the absolute path of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package, especially the executable and test files.</p>
<p>To execute the tutorials, create a working directory (<code class="codehilite">Work*</code>) and
copy there the input files and the <em>files</em> file of the lesson. This will be explicitly mentioned in the first lessons,
that will tell you more about the <em>files</em> file (see also <a class="wikilink user-guide-wikilink" href="../../guide/abinit#intro">section 1.1</a>).
The <em>files</em> file ending with <em>_x</em> (e.g. <em>tbase1_x.files</em>) <strong>must be edited</strong> every time you start to use a new input file.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="../basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel, see the <a class="wikilink topic-wikilink" data-content="How to set parameters for a parallel calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/parallelism">topic on parallelism</a>.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define some handy environment variables by
executing the following lines in the terminal:</p>
<div class="codehilite"><pre><span></span><span class="nb">export</span> <span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_the_absolute_path_to_the_abinit_top_level_dir
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span>
<span class="nb">export</span> <span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/
<span class="nb">export</span> <span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Psps_for_tests/  <span class="c1"># Pseudopotentials used in examples.</span>
</pre></div>

<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>).
The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
</div>
<h2 id="1-introduction">1 Introduction<a class="headerlink" href="#1-introduction" title="Permanent link">&para;</a></h2>
<p><em>Before continuing you might work in a different subdirectory, as for the
other tutorials. Why not <code class="codehilite">work_paral</code>?</em></p>
<p>All the input files can be found in the <code class="codehilite">Input</code> directory in the directory dedicated to this tutorial.
You might have to adapt them to the path of the working directory.
You can compare your results with reference output files located in <code class="codehilite">Refs</code>.</p>
<blockquote>
<p>In the following, when &ldquo;run ABINIT over nn CPUs&rdquo; appears, you have to
use a specific command line or submission file, according to the operating system/architecture
of your computer.</p>
</blockquote>
<!---
Some scripts are given as examples in the directory `\$ABI_HOME/doc/tutorial/paral_gspw_assets/`.
You can adapt them to your own calculations.
--->

<p>When the size of the system increases up to 100 or 1000 atoms, it is usually
impossible to perform <em>ab initio</em> calculations with a single computing core.
This is because the basis sets used to solve the problem (plane waves, bands, &hellip;) increase
&mdash; linearly, as the square, or even exponentially &mdash;.
The computational resources are limited by 2 factors:</p>
<ul>
<li>The memory, i.e. the amount of data stored in RAM,</li>
<li>The computing efficiency, with specific bottlenecks.</li>
</ul>
<p>Therefore, it is mandatory to adopt a parallelization strategy:</p>
<ol>
<li>Distribute the data or share them on a large number of computing nodes,</li>
<li>Parallelize the time consuming routines.</li>
</ol>
<p>In this tutorial, we will show:</p>
<ul>
<li>How to improve performance by using a large number of computing units (CPU cores),</li>
<li>
<p>How to decrease the computational  time for a given number of CPU cores by&hellip;</p>
<ol>
<li>Reducing the time needed to perform one electronic iteration (improve efficiency)</li>
<li>Reducing the number of electronic iterations (improve convergence)</li>
</ol>
</li>
</ul>
<p>The tests are performed on a 108 gold atom system; in this tutorial the plane-wave
cutoff energy is strongly reduced, for practical reasons.</p>
<h2 id="2-a-simple-way-to-begin-automatic-distributed-parallelism">2 A simple way to begin: automatic distributed parallelism<a class="headerlink" href="#2-a-simple-way-to-begin-automatic-distributed-parallelism" title="Permanent link">&para;</a></h2>
<p>The easiest way to activate the KGB parallelization in ABINIT is to
add just one input variable in the input file, <a class="wikilink codevar-wikilink" href="../../variables/paral#paral_kgb">paral_kgb</a>, which controls
everything concerning the KGB parallelization, including the choice of the iterative
eigensolver (<a class="wikilink codevar-wikilink" href="../../variables/dev#wfoptalg">wfoptalg</a> <strong>= 1, 4, 14, 114</strong>) and the use of a parallel 3dim-FFT.
Then you have to choose between 2 strategies:</p>
<ul>
<li>Activate the &mdash; not so good &mdash; flag <a class="wikilink codevar-wikilink" href="../../variables/paral#autoparal">autoparal</a><strong>=1</strong> (automatic parallelization)
and use the associated <a class="wikilink codevar-wikilink" href="../../variables/paral#max_ncpus">max_ncpus</a> variable (maximum number of CPU cores you want),</li>
</ul>
<p>or</p>
<ul>
<li>Manually define the number of processes associated to each level of parallelism:
  <a class="wikilink codevar-wikilink" href="../../variables/paral#npkpt">npkpt</a> (number of processes for k points),
  <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> (number of processes for bands),
  <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> (number of processes for plane-waves/FFT).</li>
</ul>
<p>OK, let&rsquo;s start!
Copy the <code class="codehilite">tgspw_01.in</code> file and the related <code class="codehilite">tgspw_01.files</code> from the tutorial directory
into your working directory.</p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-3e2a3f7e-c298-47c3-81c8-abd5bf12c20a" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tgspw_01.files
</button>
<button type="button" id="uuid-ca367e85-adb8-4329-a015-7eb37d5e4af8" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tgspw_01.in
</button>
</div></div>

<div id="uuid-747d281c-a26e-4fe8-97ea-623c33044bc7" class="my_dialog" title="tests/tutoparal/Input/tgspw_01.files" hidden><div><pre class="small-text">
tgspw_01.in
tgspw_01.out
tgspw_01.i
tgspw_01.o
tgspw_01.tmp
79au.pspnc

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-747d281c-a26e-4fe8-97ea-623c33044bc7", "#uuid-3e2a3f7e-c298-47c3-81c8-abd5bf12c20a") }); </script>

<div id="uuid-8277bf92-2cd8-45b6-9b13-fe6b314ba0e2" class="my_dialog" title="tests/tutoparal/Input/tgspw_01.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Gold with one vacancy (107 atoms of gold).</span>

<span class="c1">#Irrealist. Just to reduce the computation time</span>
 nstep <span class="m">10</span>
 ecut   <span class="m">5</span>
<span class="c1">#In order to perform some benchmark</span>
 timopt -3

<span class="c1">#For the parallelization</span>
 paral_kgb <span class="m">1</span>
 autoparal <span class="m">1</span>
 max_ncpus <span class="m">108</span>
 prteig <span class="m">0</span>

<span class="c1">#Common and usual input variables</span>
 nband <span class="m">648</span>
 acell <span class="m">3</span>*23.01
 occopt <span class="m">3</span> tsmear <span class="m">0</span>.002
 nkpt <span class="m">1</span> istwfk <span class="m">1</span>
 rprim  <span class="m">1</span>. <span class="m">0</span>. <span class="m">0</span>.
        <span class="m">0</span>. <span class="m">1</span>. <span class="m">0</span>.
        <span class="m">0</span>. <span class="m">0</span>. <span class="m">1</span>.
 toldfe <span class="m">1</span>.e-7
 znucl  <span class="m">79</span>.0
 natom  <span class="m">107</span> ntypat <span class="m">1</span> typat  <span class="m">107</span>*1
      xred    <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6326095981E-01  <span class="m">1</span>.6326095981E-01
              <span class="m">1</span>.6326095981E-01  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6326095981E-01
              <span class="m">1</span>.6326095981E-01  <span class="m">1</span>.6326095981E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6641506689E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6641506689E-01  <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">1</span>.6596912386E-01  <span class="m">3</span>.3213568011E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3251308046E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6326095981E-01  <span class="m">8</span>.3673904019E-01
              <span class="m">1</span>.6326095981E-01  <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3673904019E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">1</span>.6596912386E-01  <span class="m">6</span>.6786431989E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6748691954E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6641506689E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">3</span>.3213568011E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">1</span>.6641506689E-01  <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3251308046E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6649623194E-01  <span class="m">3</span>.3291657817E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6649623194E-01  <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3291657817E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3314040855E-01  <span class="m">3</span>.3314040855E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3358493311E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">3</span>.3213568011E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">1</span>.6649623194E-01  <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6708342183E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3314040855E-01  <span class="m">6</span>.6685959145E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3673904019E-01  <span class="m">1</span>.6326095981E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">6</span>.6786431989E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">1</span>.6326095981E-01  <span class="m">8</span>.3673904019E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6748691954E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3358493311E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6649623194E-01  <span class="m">6</span>.6708342183E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">8</span>.3403087614E-01  <span class="m">3</span>.3213568011E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6685959145E-01  <span class="m">3</span>.3314040855E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3673904019E-01  <span class="m">8</span>.3673904019E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">6</span>.6786431989E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">8</span>.3403087614E-01  <span class="m">6</span>.6786431989E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6685959145E-01  <span class="m">6</span>.6685959145E-01
              <span class="m">3</span>.3213568011E-01  <span class="m">1</span>.6596912386E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6641506689E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6641506689E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3251308046E-01  <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3291657817E-01  <span class="m">1</span>.6649623194E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6649623194E-01  <span class="m">3</span>.3291657817E-01
              <span class="m">3</span>.3314040855E-01  <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3314040855E-01
              <span class="m">3</span>.3213568011E-01  <span class="m">1</span>.6596912386E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3358493311E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6649623194E-01  <span class="m">6</span>.6708342183E-01
              <span class="m">3</span>.3314040855E-01  <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6685959145E-01
              <span class="m">3</span>.3291657817E-01  <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6649623194E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3291657817E-01  <span class="m">1</span>.6649623194E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3314040855E-01  <span class="m">3</span>.3314040855E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3316116420E-01  <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3316116420E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3316116420E-01
              <span class="m">3</span>.3302887829E-01  <span class="m">3</span>.3302887829E-01  <span class="m">3</span>.3302887829E-01
              <span class="m">3</span>.3291657817E-01  <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3350376806E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3291657817E-01  <span class="m">8</span>.3350376806E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6683883580E-01
              <span class="m">3</span>.3302887829E-01  <span class="m">3</span>.3302887829E-01  <span class="m">6</span>.6697112171E-01
              <span class="m">3</span>.3213568011E-01  <span class="m">8</span>.3403087614E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6708342183E-01  <span class="m">1</span>.6649623194E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3358493311E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3314040855E-01  <span class="m">6</span>.6685959145E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3291657817E-01  <span class="m">8</span>.3350376806E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6683883580E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3350376806E-01  <span class="m">3</span>.3291657817E-01
              <span class="m">3</span>.3302887829E-01  <span class="m">6</span>.6697112171E-01  <span class="m">3</span>.3302887829E-01
              <span class="m">3</span>.3213568011E-01  <span class="m">8</span>.3403087614E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6708342183E-01  <span class="m">8</span>.3350376806E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3350376806E-01  <span class="m">6</span>.6708342183E-01
              <span class="m">3</span>.3302887829E-01  <span class="m">6</span>.6697112171E-01  <span class="m">6</span>.6697112171E-01
              <span class="m">6</span>.6786431989E-01  <span class="m">1</span>.6596912386E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">8</span>.3673904019E-01  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6326095981E-01
              <span class="m">8</span>.3673904019E-01  <span class="m">1</span>.6326095981E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6748691954E-01  <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6708342183E-01  <span class="m">1</span>.6649623194E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3358493311E-01  <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">1</span>.6596912386E-01  <span class="m">3</span>.3213568011E-01
              <span class="m">6</span>.6685959145E-01  <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3314040855E-01
              <span class="m">6</span>.6786431989E-01  <span class="m">1</span>.6596912386E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">8</span>.3673904019E-01  <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3673904019E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">1</span>.6596912386E-01  <span class="m">6</span>.6786431989E-01
              <span class="m">6</span>.6685959145E-01  <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6685959145E-01
              <span class="m">6</span>.6708342183E-01  <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6649623194E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">3</span>.3213568011E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">8</span>.3358493311E-01  <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6685959145E-01  <span class="m">3</span>.3314040855E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6683883580E-01  <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3350376806E-01  <span class="m">3</span>.3291657817E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3350376806E-01  <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3291657817E-01
              <span class="m">6</span>.6697112171E-01  <span class="m">3</span>.3302887829E-01  <span class="m">3</span>.3302887829E-01
              <span class="m">6</span>.6708342183E-01  <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3350376806E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">3</span>.3213568011E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">8</span>.3350376806E-01  <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6708342183E-01
              <span class="m">6</span>.6697112171E-01  <span class="m">3</span>.3302887829E-01  <span class="m">6</span>.6697112171E-01
              <span class="m">6</span>.6786431989E-01  <span class="m">8</span>.3403087614E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">6</span>.6786431989E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">8</span>.3673904019E-01  <span class="m">8</span>.3673904019E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6685959145E-01  <span class="m">6</span>.6685959145E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6708342183E-01  <span class="m">8</span>.3350376806E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3350376806E-01  <span class="m">6</span>.6708342183E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">8</span>.3403087614E-01  <span class="m">3</span>.3213568011E-01
              <span class="m">6</span>.6697112171E-01  <span class="m">6</span>.6697112171E-01  <span class="m">3</span>.3302887829E-01
              <span class="m">6</span>.6786431989E-01  <span class="m">8</span>.3403087614E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">6</span>.6786431989E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">8</span>.3403087614E-01  <span class="m">6</span>.6786431989E-01
              <span class="m">6</span>.6697112171E-01  <span class="m">6</span>.6697112171E-01  <span class="m">6</span>.6697112171E-01


 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;PseudosTM_pwteter/79au.pspnc&quot;</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% expected_failure = yes</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgspw_01.out, tolnlines = 0, tolabs = 1.100e-03, tolrel = 3.000e-03</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Bottin</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description =  Gold with one vacancy (107 atoms of gold).</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-8277bf92-2cd8-45b6-9b13-fe6b314ba0e2", "#uuid-ca367e85-adb8-4329-a015-7eb37d5e4af8") }); </script>

<p>Then run ABINIT on 1 CPU core (using 1 MPI process and 1 <em>openMP</em> thread).
<!--- ADDON1 ---></p>
<p>ABINIT should stop without starting a calculation (don&rsquo;t pay attention to the error message).
At the end of the log file <code class="codehilite">*log</code>, you will see:</p>
<div class="codehilite"><pre><span></span> Computing all possible proc distributions for this input with #CPUs&lt;=108:

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 |       npkpt|       npfft|      npband|      bandpp|  #MPI(proc)|    WEIGHT|
 |    1&lt;&lt;    1|    1&lt;&lt;   22|    1&lt;&lt;  108|    1&lt;&lt;  648|    1&lt;&lt;  108|  &lt;=   108|
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 |           1|           6|          18|          12|         108|    74.762|
 |           1|           9|          12|          18|         108|    74.530|
 |           1|          12|           9|          24|         108|    73.687|
 |           1|          18|           6|          36|         108|    73.560|
 |           1|           4|          27|           8|         108|    73.037|
 |           1|           3|          36|           6|         108|    70.188|
 |           1|          12|           9|          18|         108|    70.065|
 |           1|           4|          27|           6|         108|    69.448|
 |           1|           8|          12|          18|          96|    67.032|
 |           1|          16|           6|          36|          96|    65.931|
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 Only the best possible choices for nproc are printed...
......................
</pre></div>

<p>A weight is assigned to each distribution of processors. As indicated, you are advised
to select a processor distribution with a high &ldquo;weight&rdquo;&ldquo;. If we just focus on <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a>
and <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a>, we see that, for 108 processes, the recommended distribution is (18x6).</p>
<p>In a second step you can launch ABINIT in parallel on 108 processors by
changing your input file as follows:</p>
<div class="codehilite"><pre><span></span><span class="gd">- paral_kgb 1 autoparal 1 max_ncpus 108</span>
<span class="gi">+ paral_kgb 1 npband 18 npfft 6</span>
</pre></div>

<!--- ADDON2 --->

<p>You can now perform your calculations using the KGB parallelization in ABINIT.
But somehow, you did it without understanding how you got the result&hellip;</p>
<h2 id="3-a-more-sophisticated-method">3 A more sophisticated method<a class="headerlink" href="#3-a-more-sophisticated-method" title="Permanent link">&para;</a></h2>
<p>In this part we will try to recover the previous process distribution, but with a better
understanding. As shown above, the pair (<a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> x <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a>) of input variables
can have various values: (108x1), (54x2), (36x3), (27x4), (18x6), (12x9) or (9x12).
In order to perform these 7 calculations you can use the <code class="codehilite">tgspw_02.in</code>
and <code class="codehilite">tgspw_02.files</code> files.</p>
<div class="text-center"><div class="btn-group-vertical">
<button type="button" id="uuid-5088f413-80f4-4a2c-8b2e-d4930f16ec1e" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tgspw_02.files
</button>
<button type="button" id="uuid-6391028e-3746-4e53-a926-dac5409d2e6c" class="btn btn-default btn-labeled">
  <span class="btn-label"><i class="fa fa-window-restore" aria-hidden="true"></i></span>View tests/tutoparal/Input/tgspw_02.in
</button>
</div></div>

<div id="uuid-e3966953-f806-4cf5-9050-4b50607987a1" class="my_dialog" title="tests/tutoparal/Input/tgspw_02.files" hidden><div><pre class="small-text">
tgspw_02.in
tgspw_02.out
tgspw_02.i
tgspw_02.o
tgspw_02.tmp
79au.pspnc

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-e3966953-f806-4cf5-9050-4b50607987a1", "#uuid-5088f413-80f4-4a2c-8b2e-d4930f16ec1e") }); </script>

<div id="uuid-fd9fa27e-a8d0-42e7-b035-9870d04a7756" class="my_dialog" title="tests/tutoparal/Input/tgspw_02.in" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Gold with one vacancy (107 atoms of gold).</span>

<span class="c1">#Irrealist. Just to reduce the computation time</span>
 nstep <span class="m">10</span>
 ecut   <span class="m">5</span>
<span class="c1">#In order to perform some benchmark</span>
 timopt -3

<span class="c1">#For the parallelization</span>
 paral_kgb <span class="m">1</span>
 prteig <span class="m">0</span>

<span class="c1"># Remove this line, if you are following the tutorial.</span>
 npfft <span class="m">8</span> npband <span class="m">4</span>

<span class="c1">#Common and usual input variables</span>
 nband <span class="m">648</span>
 acell <span class="m">3</span>*23.01
 occopt <span class="m">3</span> tsmear <span class="m">0</span>.002
 nkpt <span class="m">1</span> istwfk <span class="m">1</span>
 rprim  <span class="m">1</span>. <span class="m">0</span>. <span class="m">0</span>.
        <span class="m">0</span>. <span class="m">1</span>. <span class="m">0</span>.
        <span class="m">0</span>. <span class="m">0</span>. <span class="m">1</span>.
 toldfe <span class="m">1</span>.e-7
 znucl  <span class="m">79</span>.0
 natom  <span class="m">107</span> ntypat <span class="m">1</span> typat  <span class="m">107</span>*1
      xred    <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6326095981E-01  <span class="m">1</span>.6326095981E-01
              <span class="m">1</span>.6326095981E-01  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6326095981E-01
              <span class="m">1</span>.6326095981E-01  <span class="m">1</span>.6326095981E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6641506689E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6641506689E-01  <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">1</span>.6596912386E-01  <span class="m">3</span>.3213568011E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3251308046E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6326095981E-01  <span class="m">8</span>.3673904019E-01
              <span class="m">1</span>.6326095981E-01  <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3673904019E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">1</span>.6596912386E-01  <span class="m">6</span>.6786431989E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6748691954E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6641506689E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">3</span>.3213568011E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">1</span>.6641506689E-01  <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3251308046E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6649623194E-01  <span class="m">3</span>.3291657817E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6649623194E-01  <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3291657817E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3314040855E-01  <span class="m">3</span>.3314040855E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3358493311E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">3</span>.3213568011E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">1</span>.6649623194E-01  <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6708342183E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3314040855E-01  <span class="m">6</span>.6685959145E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3673904019E-01  <span class="m">1</span>.6326095981E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">6</span>.6786431989E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">1</span>.6326095981E-01  <span class="m">8</span>.3673904019E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6748691954E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3358493311E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6649623194E-01  <span class="m">6</span>.6708342183E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">8</span>.3403087614E-01  <span class="m">3</span>.3213568011E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6685959145E-01  <span class="m">3</span>.3314040855E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3673904019E-01  <span class="m">8</span>.3673904019E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">6</span>.6786431989E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">1</span>.6596912386E-01  <span class="m">8</span>.3403087614E-01  <span class="m">6</span>.6786431989E-01
              <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6685959145E-01  <span class="m">6</span>.6685959145E-01
              <span class="m">3</span>.3213568011E-01  <span class="m">1</span>.6596912386E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6641506689E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6641506689E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3251308046E-01  <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3291657817E-01  <span class="m">1</span>.6649623194E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6649623194E-01  <span class="m">3</span>.3291657817E-01
              <span class="m">3</span>.3314040855E-01  <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3314040855E-01
              <span class="m">3</span>.3213568011E-01  <span class="m">1</span>.6596912386E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3358493311E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6649623194E-01  <span class="m">6</span>.6708342183E-01
              <span class="m">3</span>.3314040855E-01  <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6685959145E-01
              <span class="m">3</span>.3291657817E-01  <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6649623194E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3291657817E-01  <span class="m">1</span>.6649623194E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3314040855E-01  <span class="m">3</span>.3314040855E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3316116420E-01  <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3316116420E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3316116420E-01
              <span class="m">3</span>.3302887829E-01  <span class="m">3</span>.3302887829E-01  <span class="m">3</span>.3302887829E-01
              <span class="m">3</span>.3291657817E-01  <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3350376806E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3291657817E-01  <span class="m">8</span>.3350376806E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6683883580E-01
              <span class="m">3</span>.3302887829E-01  <span class="m">3</span>.3302887829E-01  <span class="m">6</span>.6697112171E-01
              <span class="m">3</span>.3213568011E-01  <span class="m">8</span>.3403087614E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6708342183E-01  <span class="m">1</span>.6649623194E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3358493311E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3314040855E-01  <span class="m">6</span>.6685959145E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">3</span>.3291657817E-01  <span class="m">8</span>.3350376806E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6683883580E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3350376806E-01  <span class="m">3</span>.3291657817E-01
              <span class="m">3</span>.3302887829E-01  <span class="m">6</span>.6697112171E-01  <span class="m">3</span>.3302887829E-01
              <span class="m">3</span>.3213568011E-01  <span class="m">8</span>.3403087614E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6708342183E-01  <span class="m">8</span>.3350376806E-01
              <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3350376806E-01  <span class="m">6</span>.6708342183E-01
              <span class="m">3</span>.3302887829E-01  <span class="m">6</span>.6697112171E-01  <span class="m">6</span>.6697112171E-01
              <span class="m">6</span>.6786431989E-01  <span class="m">1</span>.6596912386E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">8</span>.3673904019E-01  <span class="m">0</span>.0000000000E+00  <span class="m">1</span>.6326095981E-01
              <span class="m">8</span>.3673904019E-01  <span class="m">1</span>.6326095981E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6748691954E-01  <span class="m">0</span>.0000000000E+00  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6708342183E-01  <span class="m">1</span>.6649623194E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3358493311E-01  <span class="m">0</span>.0000000000E+00  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">1</span>.6596912386E-01  <span class="m">3</span>.3213568011E-01
              <span class="m">6</span>.6685959145E-01  <span class="m">0</span>.0000000000E+00  <span class="m">3</span>.3314040855E-01
              <span class="m">6</span>.6786431989E-01  <span class="m">1</span>.6596912386E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">8</span>.3673904019E-01  <span class="m">0</span>.0000000000E+00  <span class="m">8</span>.3673904019E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">1</span>.6596912386E-01  <span class="m">6</span>.6786431989E-01
              <span class="m">6</span>.6685959145E-01  <span class="m">0</span>.0000000000E+00  <span class="m">6</span>.6685959145E-01
              <span class="m">6</span>.6708342183E-01  <span class="m">5</span>.0000000000E-01  <span class="m">1</span>.6649623194E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">3</span>.3213568011E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">8</span>.3358493311E-01  <span class="m">5</span>.0000000000E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6685959145E-01  <span class="m">3</span>.3314040855E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6683883580E-01  <span class="m">5</span>.0000000000E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3350376806E-01  <span class="m">3</span>.3291657817E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3350376806E-01  <span class="m">5</span>.0000000000E-01  <span class="m">3</span>.3291657817E-01
              <span class="m">6</span>.6697112171E-01  <span class="m">3</span>.3302887829E-01  <span class="m">3</span>.3302887829E-01
              <span class="m">6</span>.6708342183E-01  <span class="m">5</span>.0000000000E-01  <span class="m">8</span>.3350376806E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">3</span>.3213568011E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">8</span>.3350376806E-01  <span class="m">5</span>.0000000000E-01  <span class="m">6</span>.6708342183E-01
              <span class="m">6</span>.6697112171E-01  <span class="m">3</span>.3302887829E-01  <span class="m">6</span>.6697112171E-01
              <span class="m">6</span>.6786431989E-01  <span class="m">8</span>.3403087614E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">6</span>.6786431989E-01  <span class="m">1</span>.6596912386E-01
              <span class="m">8</span>.3673904019E-01  <span class="m">8</span>.3673904019E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6685959145E-01  <span class="m">6</span>.6685959145E-01  <span class="m">0</span>.0000000000E+00
              <span class="m">6</span>.6708342183E-01  <span class="m">8</span>.3350376806E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3350376806E-01  <span class="m">6</span>.6708342183E-01  <span class="m">5</span>.0000000000E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">8</span>.3403087614E-01  <span class="m">3</span>.3213568011E-01
              <span class="m">6</span>.6697112171E-01  <span class="m">6</span>.6697112171E-01  <span class="m">3</span>.3302887829E-01
              <span class="m">6</span>.6786431989E-01  <span class="m">8</span>.3403087614E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">6</span>.6786431989E-01  <span class="m">8</span>.3403087614E-01
              <span class="m">8</span>.3403087614E-01  <span class="m">8</span>.3403087614E-01  <span class="m">6</span>.6786431989E-01
              <span class="m">6</span>.6697112171E-01  <span class="m">6</span>.6697112171E-01  <span class="m">6</span>.6697112171E-01

 pp_dirpath <span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
 pseudos <span class="s2">&quot;PseudosTM_pwteter/79au.pspnc&quot;</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% [NCPU_32]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   tgspw_02_MPI32.out, tolnlines = 170, tolabs = 1.1e-3, tolrel = 1.0e-2 </span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 32</span>
<span class="c1">#%% nprocs_to_test = 32</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Bottin</span>
<span class="c1">#%% keywords = </span>
<span class="c1">#%% description = </span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-fd9fa27e-a8d0-42e7-b035-9870d04a7756", "#uuid-6391028e-3746-4e53-a926-dac5409d2e6c") }); </script>

<p>Change the line corresponding to the processor distribution.
A first calculation with:
<div class="codehilite"><pre><span></span><span class="gi">+ npband 108 npfft 1</span>
</pre></div></p>
<p>A second one with:
<div class="codehilite"><pre><span></span><span class="gd">- npband 108 npfft 1</span>
<span class="gi">+ npband  54 npfft 2</span>
</pre></div></p>
<p>And so on, using (36x3), (27x4), (18x6), (12x9) and (9x12).</p>
<p>Alternatively, this can be performed using a shell script including:
<div class="codehilite"><pre><span></span>cp tgspw_02.in tmp.file
<span class="nb">echo</span> <span class="s2">&quot;npband 108 npfft 1&quot;</span> &gt;&gt; tgspw_02.in
mpirun -n <span class="m">108</span> abinit &lt; tgspw_02.files &gt; log
cp tgspw_02.out tgspw_02.108-01.out
cp tmp.file tgspw_02.in
<span class="nb">echo</span> <span class="s2">&quot;npband 54 npfft 2&quot;</span> &gt;&gt; tgspw_02.in
...
</pre></div></p>
<p>Store all the output files by renaming them as follows:
<code class="codehilite">tgspw_02.108-01.out</code>, <code class="codehilite">tgspw_02.054-02.out</code>, <code class="codehilite">tgspw_02.036-03.out</code>,
<code class="codehilite">tgspw_02.027-04.out</code>, <code class="codehilite">tgspw_02.018-06.out</code>, <code class="codehilite">tgspw_02.012-09.out</code>
and <code class="codehilite">tgspw_02.009-12.out</code>.
The timing of each calculation can be retrieved using the shell command:
<div class="codehilite"><pre><span></span>grep Proc *02*out
</pre></div></p>
<div class="codehilite"><pre><span></span>tgspw_02.009-12.out:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">66</span>.1  <span class="nv">wall</span><span class="o">=</span>         <span class="m">67</span>.8
tgspw_02.012-09.out:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">63</span>.9  <span class="nv">wall</span><span class="o">=</span>         <span class="m">65</span>.6
tgspw_02.018-06.out:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">61</span>.1  <span class="nv">wall</span><span class="o">=</span>         <span class="m">62</span>.6
tgspw_02.027-04.out:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">59</span>.0  <span class="nv">wall</span><span class="o">=</span>         <span class="m">60</span>.8
tgspw_02.036-03.out:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">60</span>.6  <span class="nv">wall</span><span class="o">=</span>         <span class="m">62</span>.3
tgspw_02.054-02.out:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">63</span>.1  <span class="nv">wall</span><span class="o">=</span>         <span class="m">64</span>.8
tgspw_02.108-01.out:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">74</span>.4  <span class="nv">wall</span><span class="o">=</span>         <span class="m">76</span>.0
</pre></div>

<p>As far as the timing is concerned, the best distributions are then the ones
proposed in section 2; (27x4) seems to be the best one.
The prediction using <a class="wikilink codevar-wikilink" href="../../variables/paral#autoparal">autoparal</a><strong>=1</strong> was pretty good.</p>
<p>Up to now, we have not learned more than before. We have so far only
considered the timing of 10 electronic steps.
However the &ldquo;Locally Optimal Block Preconditioned Conjugate Gradient&rdquo; algorithm (LOBPCG)
&mdash; used in ABINIT by default &mdash; operates a diagonalization by block of eigenvectors.
Each block of eigenvectors is concurrently diagonalized by the <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> processes,
one block after the other. When the <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> value is modified, the size of the block
changes accordingly (it is exactly equal to <code class="codehilite">npband</code>), and the solutions of the eigensolver are modified.
One calculation can be the quickest if we look at the time needed by one iteration
but the slowest at the end because many more steps are performed.
In order to see this, we can have a look at the convergence rate at the end
of the calculations.
The last iterations of the SCF loops are:
<div class="codehilite"><pre><span></span>grep <span class="s2">&quot;ETOT 10&quot;</span> *02*out
tgspw_02.009-12.out: ETOT <span class="m">10</span>  -4191.7097103563     <span class="m">3</span>.739E-04 <span class="m">1</span>.171E-05 <span class="m">6</span>.693E+00
tgspw_02.012-09.out: ETOT <span class="m">10</span>  -4191.7096733078     <span class="m">2</span>.111E-04 <span class="m">1</span>.702E-05 <span class="m">6</span>.999E+00
tgspw_02.018-06.out: ETOT <span class="m">10</span>  -4191.7102597852     <span class="m">1</span>.384E-04 <span class="m">2</span>.298E-05 <span class="m">4</span>.033E+00
tgspw_02.027-04.out: ETOT <span class="m">10</span>  -4191.7107673046    -6.372E-06 <span class="m">1</span>.772E-05 <span class="m">1</span>.947E+00
tgspw_02.036-03.out: ETOT <span class="m">10</span>  -4191.7111202227    -1.791E-04 <span class="m">1</span>.875E-05 <span class="m">1</span>.097E+00
tgspw_02.054-02.out: ETOT <span class="m">10</span>  -4191.7113973688    -2.561E-04 <span class="m">1</span>.181E-05 <span class="m">3</span>.156E-01
tgspw_02.108-01.out: ETOT <span class="m">10</span>  -4191.7114913729    -4.742E-05 <span class="m">1</span>.646E-05 <span class="m">3</span>.480E-02
</pre></div></p>
<p>The last column indicates the convergence of the <strong>potential
residual</strong>. You can see that this quantity is the smallest when <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> is
the highest. This result is expected: the convergence is better when the size
of the block is the largest. But this (best) convergence is obtained for
the (108x1) distribution&hellip; when the worst timing is measured.</p>
<p>So, you face a dilemma. The calculation with the smallest number of iterations
(the best convergence) is not the best concerning the timing of one iteration
(the best efficiency), and vice versa&hellip; The best choice is a compromise.</p>
<p>In the following we will choose the (27x4) pair, because it
definitively offers more guarantees concerning the convergence and the timing.</p>
<blockquote>
<p>Note:
You could check that the convergence is not changed when the <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a>
value is modified.</p>
</blockquote>
<h2 id="4-even-more-sophisticated-bands-per-process-bandpp">4 Even more sophisticated: BANDs Per Process (bandpp)<a class="headerlink" href="#4-even-more-sophisticated-bands-per-process-bandpp" title="Permanent link">&para;</a></h2>
<p>We have seen in the previous section that the best convergence is obtained
when the size of the block is the largest. This size was exactly equal to the
<a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> value. It was only possible to increase the block size by increasing
the number of MPI processes.</p>
<p><em>Is it possible to do better?</em>
The answer is <em>yes</em>! The input variable named <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> (BANDs Per Process)
enables an increasing of the block size without changing the number of processes
dedicated to bands.</p>
<p><em>How does this work?</em>
As previoulsy, each block of bands is diagonalized by <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> MPI processes in parallel.
But, if <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> is activated, each process handles <code class="codehilite">bandpp</code> bands (sequentially).
The block size &mdash; exactly equal to the number of bands handled by the <em>band
processes</em> &mdash; is now equal to <code class="codehilite">npband x bandpp</code>. Accordingly the block size can be
modified (usually increased) by playing with the value of <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a>, without changing
the number of MPI processes.
Note also that scalar products and FFTs are done by the <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> MPI processes.</p>
<p>In the following we use the same settings as previously, just changing:</p>
<div class="codehilite"><pre><span></span><span class="gi">+ nstep 20</span>
<span class="gi">+ paral_kgb 1 npband 27 npfft 4 bandpp 1</span>
</pre></div>

<p>Copy the input files <code class="codehilite">tgspw_03.files</code> and <code class="codehilite">tgspw_03.in</code> then run ABINIT over 108 CPUs,
setting <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a><strong>=1</strong> and then <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a><strong>=2</strong>. The output files will be
named <code class="codehilite">tgspw_03.bandpp1.out</code> and <code class="codehilite">tgspw_03.bandpp2.out</code>, respectively. A
comparison of these two files shows that the convergence is better in the
second case.
Conclusion: for a given number of processors, it is possible to improve
the convergence by increasing bandpp.</p>
<p>We can also compare the (27x4)+<a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a><strong>=2</strong> distribution with
the (54x2)+<a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a><strong>=1</strong> one.
Use the same input file and change it according to:</p>
<div class="codehilite"><pre><span></span><span class="gd">- paral_kgb 1 npband 27 npfft 4 bandpp 2</span>
<span class="gi">+ paral_kgb 1 npband 54 npfft 2 bandpp 1</span>
</pre></div>

<p>Then run ABINIT over 108 CPUs and name the output file <code class="codehilite">tgspw_03.054-02.out</code>.
Perform a <code class="codehilite">diff</code> between the two output files <code class="codehilite">tgspw_03.bandpp1.out</code>
and <code class="codehilite">tgspw_03.054-02.out</code>. As you can see, the two calculations give exactly the same
convergence rate. This was expected since, in both cases, the block sizes are equal (to 54)
and the number of FFT processors <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> does not affect the convergence.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
</div>
<blockquote>
<p>It is possible to adjust the distribution of processes, without changing the
convergence, by reducing <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> and increasing <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> proportionally.</p>
</blockquote>
<p>However, as you can see in the previous calculations, the CPU time per iteration
increases when <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> increases (note that the 2<sup>nd</sup> run performed less iterations
than the first one):</p>
<div class="codehilite"><pre><span></span>grep Proc tgspw_03.bandpp1.out tgspw_03.bandpp2.out
tgspw_03.bandpp1.out:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">97</span>.4  <span class="nv">wall</span><span class="o">=</span>         <span class="m">99</span>.3
tgspw_03.bandpp2.out:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">96</span>.3  <span class="nv">wall</span><span class="o">=</span>         <span class="m">98</span>.2
</pre></div>

<p><em>Where does this CPU time consumption come from?</em>
As previously explained, each MPI processes handles <code class="codehilite">bandpp</code> bands <strong>sequentially</strong>.
Thus the <em>sequential part</em> of the code increases when <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> increases.
So, <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a><strong>&gt;1</strong> is usually mandatory but do not increase it too much;
do it only if you want to improve
the convergence rate whatever the cost in total timing.</p>
<p>We will see in the next section how the use of <em>hybrid parallelism</em> can improve this&hellip;</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
</div>
<blockquote>
<p>Using only MPI parallelism, the timing of a single electronic step increases
when <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a> increases but the convergence rate is better.</p>
</blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
</div>
<blockquote>
<p>The only exception is when <a class="wikilink codevar-wikilink" href="../../variables/dev#istwfk">istwfk</a> = 2, i.e. when the wavefunctions are real.
This occurs when only the &Gamma; point  is used in the Brillouin Zone.
For even values of <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a>, the real wavefunctions are associated in pairs
in the complex FFTs, leading to a reduction by a factor of their cost.
When calculations are performed at &Gamma; point you are strongly
encouraged to use <code class="codehilite">bandpp=2, 4,...</code> (even).</p>
</blockquote>
<h2 id="5-hybrid-parallelism-mpiopenmp">5 Hybrid parallelism: MPI+<em>openMP</em><a class="headerlink" href="#5-hybrid-parallelism-mpiopenmp" title="Permanent link">&para;</a></h2>
<p>In modern supercomputers, the computing units (CPU cores) are no more equally distributed.
They are grouped by <strong>nodes</strong> in which they share the same memory access.
In so-called <em>many-core</em> architecture CPU cores can be numerous on the same node.
You could continue to use them as if they were not sharing the memory (using MPI only)
but this is not the most efficient way to take benefit from the computer.
The best practice is to used <em>hybrid</em> parallelism, mixing distributed memory parallelism
(MPI, between nodes) and shared memory parallelism ( <em>openMP</em>, inside a node). As you will
see, this will also have consequences on the performance of the iterative diagonalization
algorithm (LOBPCG).
Let&rsquo;s try!</p>
<p>We are going to run ABINIT using 2 threads. Copy the <code class="codehilite">tgspw_04.files</code> and <code class="codehilite">tgspw_04.in</code>
files and run ABINIT using 54 MPI processes and 2 <em>openMP</em> threads (by setting <code class="codehilite">OMP_NUM_THREADS=2</code> in your environment).
Note: <code class="codehilite">54MPI x 2threads = 108 CPU cores</code>.
<!--- ADDON3 ---></p>
<blockquote>
<p><strong>Important note</strong>:
When using threads, we have to impose <a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a><strong>=1</strong>.
The best is to suppress it from the input file.</p>
</blockquote>
<p>Let&rsquo;s have a look at the timings and compare them to the same run without <em>openMP</em> threads:</p>
<div class="codehilite"><pre><span></span>grep Proc tgspw_03.bandpp2.out tgspw_04.bandpp2.2threads.out
tgspw_03.bandpp2.out:         - Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">96</span>.3  <span class="nv">wall</span><span class="o">=</span>         <span class="m">98</span>.2
tgspw_04.bandpp2.2threads.out:- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>        <span class="m">147</span>.9  <span class="nv">wall</span><span class="o">=</span>        <span class="m">148</span>.8
</pre></div>

<p>As you can wee, the new output file show a larger computing time for process 0: disappointing?
Not really: you have to keep in mind that this timing is for one MPI process, adding the timings
of all the <em>openMP</em> tasks for this process. In the pure MPI case, we thus have <code class="codehilite">96 sec.</code> per task;
but in the <em>hybrid</em> case, we have <code class="codehilite">148/2=74 sec.</code> per task. For the total 108 CPUS, the time
used by ABINIT is <code class="codehilite">96x108=10368 sec.</code> in the MPI case, <code class="codehilite">74*108=7992 sec.</code> in the hybrid case.
This is better!
The best way to confirm that is to look at the <em>Wall Time</em> (cumulated on all tasks) at the end
of the output file:</p>
<div class="codehilite"><pre><span></span>grep Overall tgspw_03.bandpp2.out tgspw_04.bandpp2.2threads.out
tgspw_03.bandpp2.out:         +Overall <span class="nb">time</span> at end <span class="o">(</span>sec<span class="o">)</span> : <span class="nv">cpu</span><span class="o">=</span>      <span class="m">10429</span>.3  <span class="nv">wall</span><span class="o">=</span>      <span class="m">10607</span>.3
tgspw_04.bandpp2.2threads.out:+Overall <span class="nb">time</span> at end <span class="o">(</span>sec<span class="o">)</span> : <span class="nv">cpu</span><span class="o">=</span>       <span class="m">8003</span>.9  <span class="nv">wall</span><span class="o">=</span>       <span class="m">8033</span>.4
</pre></div>

<p><em>How does ABINIT distribute the workload?</em>
Each block of bands is diagonalized by <a class="wikilink codevar-wikilink" href="../../variables/paral#npband">npband</a> MPI processes in parallel.
As previously, each process handles <code class="codehilite">bandpp</code> bands but now using the <em>openMP</em> tasks.
This means that <code class="codehilite">bandpp x npband</code> bands are computed in parallel using
<code class="codehilite">nthreads x npband</code> tasks (<code class="codehilite">bandpp</code> has thus to be a multiple of <code class="codehilite">nthreads</code>).
This is in principle more efficient than in the pure MPI case.
Scalar products and FFTs are done in parallel by the <em>openMP</em> tasks (<a class="wikilink codevar-wikilink" href="../../variables/paral#npfft">npfft</a> not used).
So, note that there are subtle differences with the pure MPI case.</p>
<blockquote>
<p><strong>Important note</strong>:
When using threads, <code class="codehilite">bandpp</code> has to be a multiple of the number of threads.</p>
</blockquote>
<p><em>How do we choose the number of threads?</em>
It strongly depends on the computer architecture!</p>
<blockquote>
<p>A computer is made of <code class="codehilite">nodes</code>. On each node, there are <code class="codehilite">sockets</code> containing a given number
of CPU cores. All the cores of the node can access the RAM of all the <code class="codehilite">sockets</code> but this access
is faster on their own <code class="codehilite">socket</code>. This is the origin of the famous <em>Non Uniform Memory
Access</em> effect (NUMA). The number of <code class="codehilite">threads</code> has thus to be a divisor of the total
number of CPU cores in the node, but it is better to choose a divisor of the number of
cores in a <code class="codehilite">socket</code>. Indeed ABINIT performance is very sensitive to NUMA effect.</p>
</blockquote>
<!--- ADDON5 --->

<p>In the following, let&rsquo;s learn how to use ABINIT on 6 <em>openMP</em> threads&hellip;
First we change the input file as follows:</p>
<div class="codehilite"><pre><span></span><span class="gd">- paral_kgb 1 npband 54 bandpp 2</span>
<span class="gi">+ paral_kgb 1 npband 18 bandpp 6</span>
</pre></div>

<!--- ADDON6 --->

<p>Then we run ABINIT using 18 MPI processes and 6 threads (still 108 CPUs).
And we compare the timing of this &ldquo;6 threads&rdquo; case with the &ldquo;2 threads&rdquo; case:</p>
<div class="codehilite"><pre><span></span>grep Overall tgspw_04.bandpp2.2threads.out tgspw_04.bandpp6.6threads.out
tgspw_04.bandpp2.2threads.out:+Overall <span class="nb">time</span> at end <span class="o">(</span>sec<span class="o">)</span> : <span class="nv">cpu</span><span class="o">=</span>       <span class="m">8003</span>.9  <span class="nv">wall</span><span class="o">=</span>       <span class="m">8033</span>.4
tgspw_04.bandpp6.6threads.out:+Overall <span class="nb">time</span> at end <span class="o">(</span>sec<span class="o">)</span> : <span class="nv">cpu</span><span class="o">=</span>       <span class="m">5452</span>.4  <span class="nv">wall</span><span class="o">=</span>       <span class="m">5442</span>.8
</pre></div>

<p>We again have improved ABINIT performances!</p>
<p><em>Can we do better?</em>
In principle, yes. As previously explained, we have to increase the block size for
the LOBPCG diagonalization algorithm. Let&rsquo;s try it, just changing the <a class="wikilink codevar-wikilink" href="../../variables/paral#bandpp">bandpp</a>
value in input file:</p>
<div class="codehilite"><pre><span></span><span class="gd">- paral_kgb 1 npband 54 bandpp 2</span>
<span class="gi">+ paral_kgb 1 npband 18 bandpp 12</span>
</pre></div>

<p>We don&rsquo;t change here the number of threads (keeping 6).
And we obtain the following timings:</p>
<div class="codehilite"><pre><span></span>grep Overall tgspw_04.bandpp6.6threads.out tgspw_04.bandpp12.6threads.out
tgspw_04.bandpp6.6threads.out: +Overall time at end (sec) : cpu=       5452.4  wall=       5442.8
tgspw_04.bandpp12.6threads.out:+Overall time at end (sec) : cpu=       6426.2  wall=       6414.9
</pre></div>

<p>The new settings do not give a better result&hellip;</p>
<p>To help you in choosing the distribution of processes/tasks, you can launch ABINIT with
the <a class="wikilink codevar-wikilink" href="../../variables/paral#autoparal">autoparal</a><strong>=1</strong> and <a class="wikilink codevar-wikilink" href="../../variables/paral#max_ncpus">max_ncpus</a> keywords. <a class="wikilink codevar-wikilink" href="../../variables/paral#max_ncpus">max_ncpus</a> should be equal the
total number of targeted CPU cores, i.e. <code class="codehilite">nthreads x nMPI</code> and you should launch ABINIT on 1 MPI
process with <code class="codehilite">OMP_NUM_THREADS=nn</code>.
You can try this with <code class="codehilite">max_ncpus=108</code> and <code class="codehilite">OMP_NUM_THREADS=6</code>&hellip;</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
</div>
<blockquote>
<p>The rules to distribute the workload are:</p>
<ul>
<li><code class="codehilite">npband x bandpp</code> (size of a block) should be maximalized.
   It has to divide the number of bands (<code class="codehilite">nband</code>)</li>
<li><code class="codehilite">bandpp</code> has to be a multiple of the number of <em>openMP</em> tasks</li>
<li><code class="codehilite">nband</code> has to be a multiple of <code class="codehilite">npband x bandpp</code>.
  Using <a class="wikilink codevar-wikilink" href="../../variables/paral#autoparal">autoparal</a>, the code gives you some good values for <code class="codehilite">nband</code>.</li>
<li>In any case, the ideal distribution is system dependent!</li>
</ul>
</blockquote>
<h2 id="6-the-kgb-parallelization">6 The KGB parallelization<a class="headerlink" href="#6-the-kgb-parallelization" title="Permanent link">&para;</a></h2>
<p>Up to now, we only performed a &ldquo;GB&rdquo; parallelization, using 2 levels (bands and/or FFT).
If the system has more than 1 <em>k-point</em>, one can add a third level of parallelization
and perform a full &ldquo;KBG&rdquo; parallelization. There is no difficulty in
adding processes to this level.</p>
<p>To test the full parallelism, we restart
with the same input file as in section 3 and add a denser <em>k-point</em> grid.
In this case, the system has 4 <em>k-points</em> in
the <em>irreducible Brillouin zone</em> (IBZ) so the calculation can be parallelized over (at most) 4 <em>k-points</em>
MPI processes. This is done using the <a class="wikilink codevar-wikilink" href="../../variables/paral#npkpt">npkpt</a> input variable:</p>
<div class="codehilite"><pre><span></span><span class="gd">- paral_kgb 1 npband 27 npfft 4 bandpp 1</span>
<span class="gi">+ paral_kgb 1 npkpt 4 npband 27 npfft 4 bandpp 1</span>
</pre></div>

<p>We need 4 times more processes than before, so run ABINIT over
432 CPU cores (only MPI) with the <code class="codehilite">tgspw_05.in</code> and <code class="codehilite">tgspw_05.files</code> files.
The timing obtained in the output file <em>tgspw_05.out</em>&hellip;</p>
<div class="codehilite"><pre><span></span>grep Proc tgspw_05.out
- Proc.   <span class="m">0</span> individual <span class="nb">time</span> <span class="o">(</span>sec<span class="o">)</span>: <span class="nv">cpu</span><span class="o">=</span>         <span class="m">69</span>.8  <span class="nv">wall</span><span class="o">=</span>         <span class="m">71</span>.9
</pre></div>

<p>is quasi-identical to the one obtained for 1 <em>k-point</em> (see <code class="codehilite">tgspw_02.027-04.out</code>).
This means that the scalability of ABINIT is quasi-linear on the <em>k-point</em> level.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When you want to parallelize a calculation, begin by the k-point level, then
follow with the band level; then activate the FFT level or openMP threads.</p>
</div>
<p>Here, the timing obtained for the output <code class="codehilite">tgspw_05.out</code> leads to a hypothetical
speedup of 346, which is good, but not 432 as expected if the scaling was
linear. Indeed, the time needed here is slightly longer (10 sec. more) than
the one obtained in <code class="codehilite">tgspw_02.027-04.out</code>.
To go further, let&rsquo;s compare the time spent in all the routines.
A first clue comes from the timing done outside the &ldquo;vtowfk level&rdquo;,
which contains 99% of sequential processor time:</p>
<div class="codehilite"><pre><span></span>grep <span class="s2">&quot;vtowfk   &quot;</span> tgspw_05.out tgspw_02.027-04.out
tgspw_05.out:       - vtowfk   <span class="m">21028</span>.382  <span class="m">68</span>.3  <span class="m">21042</span>.797  <span class="m">67</span>.9  <span class="m">4320</span>
tgspw_05.out:       - vtowfk   <span class="m">21028</span>.382  <span class="m">68</span>.3  <span class="m">21042</span>.797  <span class="m">67</span>.9  <span class="m">4320</span>
tgspw_02.027-04.out:- vtowfk    <span class="m">5154</span>.681  <span class="m">80</span>.8   <span class="m">5155</span>.008  <span class="m">78</span>.6  <span class="m">1080</span>
tgspw_02.027-04.out:- vtowfk    <span class="m">5154</span>.681  <span class="m">80</span>.8   <span class="m">5155</span>.008  <span class="m">78</span>.6  <span class="m">1080</span>
</pre></div>

<p>We see that the KGB parallelization performs really well, since the wall time
spent within <code class="codehilite">vtowfk</code> is approximatively equal: <span><span class="MathJax_Preview">21028/432\approx 5154/108</span><script type="math/tex">21028/432\approx 5154/108</script></span>.
So, the speedup is quasi-linear in <code class="codehilite">vtowfk</code>. The problem comes from parts outside
<code class="codehilite">vtowfk</code> which are not parallelized and are responsible for the negligible
(1-99.xyz)% of time spent in sequential. These parts are no longer negligible
when you parallelize over hundreds of processors. The time spent in <code class="codehilite">vtowfk</code>
corresponds to 84.8% of the overall time when you don&rsquo;t parallelize over k-points,
and only 70.7% when you parallelize.</p>
<p>This behaviour is related to the <a href="https://en.wikipedia.org/wiki/Amdahl%27s_law">Amdhal&rsquo;s law</a>:</p>
<blockquote>
<p>The speedup of a program using multiple processes in parallel computing is
limited by the time needed for the sequential fraction of the program.</p>
<p>For example, if a program needs 20 hours using a single processor core,
and a particular portion of 1 hour cannot be parallelized, while the remaining
portion of 19 hours (95%) can be parallelized, then regardless of how
many processor cores we have, the minimum execution time cannot be
less than that critical 1 hour. Hence the speedup is limited to 20.</p>
</blockquote>
<p>In our case, the part above the loop over <em>k-points</em> in not parallelized by the
KGB parallelization. Even if this part is very small &mdash; less than 1% &mdash;
it determines an upper bound for the speedup.</p>
<p><sub><sup>To do in the future: discuss convergence, wfoptalg, nline</sup></sub></p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/git_and_gitlab/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/geometry/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Tutorial"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Tutorial" class="md-tabs__link md-tabs__link--active">
          Tutorial
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/geometry/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/git_and_gitlab/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../basepar/" title="Base" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Base
              </span>
            </div>
          </a>
        
        
          <a href="../paral_gswvl/" title="GSWVL" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                GSWVL
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 9.2.2</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2021 The Abinit Group (FB, JB, MT)
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-116681470-1","docs.abinit.org"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>